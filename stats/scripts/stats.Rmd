---
title: GitLab Advisory Database Stats
output:
  html_document:
    toc: false
    theme: sandstone
---

```{r include=FALSE, setup-hook, echo=FALSE}
require(lubridate)
require(ggplot2)
```

### Adivsory distribution

The pie chart below illustrates the advisory distribution for the package types we support by providing their total number and percentages.

```{r echo=FALSE}
source('compute_charts.R')
package_type_distro('../data/data.csv')
```


### Number of CVEs

The pie chart below illustrates how many advisories in the database are originating from NVD.

```{r echo=FALSE}
source('compute_charts.R')
cve_distro('../data/data.csv')
```


### Number of merged CVEs

The barchart below depicts the number of advisories (CVEs only) that have been merged during the last couple of months starting from May 2019 where the initial data was imported to gemnasium-db. Note, that we are only counting newly added advisories (not updated ones).

```{r echo=FALSE}
source('compute_charts.R')
merged_advisories('../data/data.csv')
```


### Throughput

Throughput indicates the efficiency of adding new advisories to gemnasium-db; more automation increases the throughput.
The plot below shows how the throughput developed over the last couple of month. For every month throughput is computed with: $\frac{|\text{Advisories}|}{\text{day}}$. The spike for May 2019 is due to the initial import of advisory data.

```{r echo=FALSE}
source('compute_charts.R')
throughput('../data/data.csv')
```

### Coverage 

Coverage indicates how many advisories from NVD have been identified as relevant in the context of dependency scanning. The barchart below shows how many CVEs (in %) were translated into advisories because of their relation to a supported package. The X-axis depicts the year of the NVD data feed wheras the Y-asis depicts percentage of extracted CVEs.

```{r echo=FALSE}
source('compute_charts.R')
coverage('../data/data.csv', '../data/nvd.csv')
```

### TTM (Time to Merge)

Time to merge (TTM) measures the expired time between the publication of a CVE on NVD and the point in time where the advisory is merged into gemnasium-db.

The figure below shows the TTM distribution per month considering a merge window of 30 days. The whiskers of the box plot show the minimum and maximum TTM values, the blue bars denote the median values and the red points denote the mean values. The median bar denotes the 50% mark: half of the advisories have been merged within a TTM below the median mark. The circles denote outliers, i.e., advisories with an unusual MTTM. The third quartile (i.e., the upper bound of the grey area above the median bar) denotes the 75% mark: three quarter of the advisories have been merged within a TTM below that mark. 

```{r echo=FALSE}
source('compute_charts.R')
acc_ttm_week_box('../data/data.csv', FALSE, 30)
```

The figure below illustrates the Weekly MTTM distribution.

```{r dpi = 200, echo=FALSE}
source('compute_charts.R')
acc_ttm_week_box('../data/data.csv', TRUE, 30)
```

