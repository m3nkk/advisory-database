---
identifier: "GMS-2022-3205"
identifiers:
- "GHSA-jjc5-fp7p-6f8w"
- "GMS-2022-3205"
package_slug: "npm/shescape"
title: "Shescape prior to 1.5.8 vulnerable to insufficient escaping of line feeds
  for CMD"
description: "### Impact\n\nThis impacts users that use Shescape (any API function)
  to escape arguments for **cmd.exe** on **Windows**. An attacker can omit all arguments
  following their input by including a line feed character (`''`) in the payload.
  Example:\n\n```javascript\nimport cp from \"node:child_process\";\nimport * as shescape
  from \"shescape\";\n\n// 1. Prerequisites\nconst options = {\n shell: \"cmd.exe\",\n};\n\n//
  2. Attack\nconst payload = \"attacker\";\n\n// 3. Usage\nlet escapedPayload;\nescapedPayload
  = shescape.escape(payload, options);\n// Or\nescapedPayload = shescape.escapeAll([payload],
  options)[0];\n// Or\nescapedPayload = shescape.quote(payload, options);\n// Or\nescapedPayload
  = shescape.quoteAll([payload], options)[0];\n\ncp.execSync(`echo Hello ${escapedPayload}!
  How are you doing?`, options);\n// Outputs: \"Hello attacker\"\n```\n\n> **Note**:
  `execSync` is just illustrative here, all of `exec`, `execFile`, `execFileSync`,
  `fork`, `spawn`, and `spawnSync` can be attacked using a line feed character if
  CMD is the shell being used.\n\n### Patches\n\nThis bug has been patched in [v1.5.8]
  which you can upgrade to now. No further changes are required.\n\n### Workarounds\n\nAlternatively,
  line feed characters (`''`) can be stripped out manually or the user input can be
  made the last argument (this only limits the impact).\n\n### References\n\n- https://github.com/ericcornelissen/shescape/pull/332\n-
  https://github.com/ericcornelissen/shescape/releases/tag/v1.5.8\n\n### For more
  information\n\nIf you have any questions or comments about this advisory:\n\n- Comment
  on https://github.com/ericcornelissen/shescape/pull/332\n- Open an issue at https://github.com/ericcornelissen/shescape/issues
  (_New issue_ > _Question_ > _Get started_)\n\n[v1.5.8]: https://github.com/ericcornelissen/shescape/releases/tag/v1.5.8\n"
date: "2022-07-15"
pubdate: "2022-07-15"
affected_range: "<1.5.8"
fixed_versions:
- "1.5.8"
affected_versions: "All versions before 1.5.8"
not_impacted: "All versions starting from 1.5.8"
solution: "Upgrade to version 1.5.8 or above."
urls:
- "https://github.com/ericcornelissen/shescape/security/advisories/GHSA-jjc5-fp7p-6f8w"
- "https://github.com/ericcornelissen/shescape/pull/332"
- "https://github.com/ericcornelissen/shescape/releases/tag/v1.5.8"
- "https://github.com/advisories/GHSA-jjc5-fp7p-6f8w"
uuid: "ebfd1a76-1d0d-4ff4-a13b-e3a29a7b823a"
cwe_ids:
- "CWE-1035"
- "CWE-937"
