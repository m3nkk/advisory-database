source_identifier: CVE-2018-3728
title: Prototype pollution attack
description: The `merge` function, and the `applyToDefaults` and `applyToDefaultsWithShallow`
  functions which leverage `merge` behind the scenes, are vulnerable to a prototype
  pollution attack when provided an unvalidated payload created from a JSON string
  containing the `__proto__` property.
date: "2018-02-15"
affected_range: '<4.2.1 || >= 5.0.0alpha0 < 5.0.3'
fixed_versions:
- 4.2.1
- 5.0.3
affected_versions: 'All versions before 4.2.1, all versions starting from 5.0.0alpha0
  before 5.0.3'
solution: Upgrade to latest version.
credit: HoLyVieR
urls:
- https://github.com/hapijs/hoek/commit/32ed5c9413321fbc37da5ca81a7cbab693786dee
- https://github.com/hapijs/hoek/commit/5aed1a8c4a3d55722d1c799f2368857bf418d6df
- https://hackerone.com/reports/310439
- https://nodesecurity.io/advisories/566
uuid: ecfd31cc-df09-48ff-9f79-af1c4f989b49
package_slug: npm/hoek
