---
identifier: "GMS-2022-2867"
identifiers:
- "GHSA-ffmh-x56j-9rc3"
- "GMS-2022-2867"
package_slug: "npm/jquery-validation"
title: "Regular Expression Denial of Service in jquery-validation"
description: "**Summary**\n\nThe issue is the same as CVE-2021-43306: An exponential
  ReDoS (Regular Expression Denial of Service) can be triggered in the jquery-validation
  npm package, when an attacker is able to supply arbitrary input to the url2 method\n\nThe
  fix for CVE-2021-43306, which was suggested by me ([@erik-krogh](https://github.com/erik-krogh)),
  was incomplete. I didn't know at the time that the fix was incomplete, but the ReDoS
  analysis in CodeQL has improved since then.\n\n**Details**\nIssue: ReDoS in url2.js
  (GHSL-2022-039)\n\nBelow is a PoC that contains the relevant regular expression.
  Run following script with node and you will notice that it does not terminate.\n\n```js\nconst
  reg = /^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.?)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i;\n\nconst
  str = \"//\" + \"00\".repeat(50)\n\nconsole.log(reg.test(str));\n...\n```\n\nThe
  bad fix was identified using CodeQL, and the alert is visible on LGTM.com: https://lgtm.com/projects/g/jquery-validation/jquery-validation/snapshot/fec195de32da23c813b08a6a786a7f1cb6567069/files/src/additional/url2.js?sort=name&dir=ASC&mode=heatmap#x9013eb6c276f2ced:1\nImpact\n\nThis
  issue may lead to DoS.\nRemediation\n\nThe new vulnerability has since been fixed
  in the gist that the regular expression was copy-pasted from: https://gist.github.com/dperini/729294#file-regex-weburl-js-L62
  So the fix is just to copy-paste that new version (copy pasted below).\n\n```js\n/^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i\n```"
date: "2022-07-05"
pubdate: "2022-07-05"
affected_range: "<1.19.5"
fixed_versions:
- "1.19.5"
affected_versions: "All versions before 1.19.5"
not_impacted: "All versions starting from 1.19.5"
solution: "Upgrade to version 1.19.5 or above."
urls:
- "https://github.com/jquery-validation/jquery-validation/security/advisories/GHSA-ffmh-x56j-9rc3"
- "https://github.com/advisories/GHSA-ffmh-x56j-9rc3"
uuid: "a8aac1ee-20f5-4dc4-a9ba-65f6d54c80be"
cwe_ids:
- "CWE-1035"
- "CWE-937"
