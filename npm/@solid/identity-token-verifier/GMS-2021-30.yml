---
identifier: "GMS-2021-30"
identifiers:
- "GHSA-xmh9-rg6f-j3mr"
- "GMS-2021-30"
package_slug: "npm/@solid/identity-token-verifier"
title: "Verification flaw in Solid identity-token-verifier"
description: "### Impact\n#### Severity\nAny Pod on a Solid server using a vulnerable
  version of the identity-token-verifier library is at risk of a spoofed Demonstration
  of Proof-of-Possession (DPoP) token binding. This vulnerability could give total
  and complete access to a targeted Pod.\n\n#### Summary\nA verification flaw in the
  implementation of the identity token verifier library (https://github.com/solid/identity-token-verifier)
  allows DPoP proofs to be spoofed. \n\nDPoP proofs are used to bind access tokens
  to a private key meant to be in sole possession of a specific user. Instead of verifying
  against the hash of an embedded public key, the library instead verifies against
  a field that an attacker can modify to spoof another userâ€™s DPoP. \n\nA stolen DPoP
  proof, when used in the right context, therefore allows the rebinding of a DPoP-bound
  access token. Any attacker in possession of a targeted access token could build
  an attack environment to replay it on any Pod service with this vulnerability. \n\n\n###
  Patches\nA new of identity-token-verifier fixes the verification: https://github.com/solid/identity-token-verifier/blob/7e18d86d65ee681e8ae912b6a032a1bae3cae570/src/lib/DPoP.ts#L25-L35\n\n###
  Workarounds\nNone\n\n### References\n_Are there any links users can visit to find
  out more?_\n\n### For more information\nIf you have any questions or comments about
  this advisory:\n* Open an issue in the [identity-token-verifier](https://github.com/solid/identity-token-verifier/)
  repository.\n* Email: info@solidproject.org"
date: "2021-03-12"
pubdate: "2021-03-12"
affected_range: "<0.5.2"
fixed_versions:
- "0.5.2"
affected_versions: "All versions before 0.5.2"
not_impacted: "All versions starting from 0.5.2"
solution: "Upgrade to version 0.5.2 or above."
urls:
- "https://github.com/solid/identity-token-verifier/security/advisories/GHSA-xmh9-rg6f-j3mr"
- "https://github.com/solid/identity-token-verifier/commit/fbdeb4aa8c12694b3744cd0454acb826817d9e6c"
- "https://github.com/solid/identity-token-verifier/releases/tag/0.5.2"
- "https://www.npmjs.com/package/@solid/identity-token-verifier"
- "https://github.com/advisories/GHSA-xmh9-rg6f-j3mr"
uuid: "e265c367-e8b4-4e06-abea-179e2b6dd82d"
cwe_ids:
- "CWE-1035"
- "CWE-937"
