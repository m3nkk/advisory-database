---
identifier: "GMS-2023-393"
identifiers:
- "GHSA-j2wh-wrv3-4x4g"
- "GMS-2023-393"
package_slug: "npm/@graphql-mesh/http"
title: "Unwanted access to the entire file system vulnerability due to a missing check
  in `staticFiles` HTTP handler"
description: "### Summary\nMissing check vulnerability in the static file handler
  allows any client to access the files in the server's file system\n\n### Details\nWhen
  `staticFiles` is set in the `serve` settings in the configuration file, the following
  handler does not check if `absolutePath` is still under the directory provided as
  `staticFiles`;\n\n```ts\n if (staticFiles) {\n  router.get('/:relativePath+', async
  request => {\n   let { relativePath } = request.params;\n   if (!relativePath) {\n
  \   relativePath = 'index.html';\n   }\n   const absolutePath = path.join(baseDir,
  staticFiles, relativePath);\n   if (absolutePath.includes(staticFiles) && (await
  pathExists(absolutePath))) {\n    const readStream = fs.createReadStream(absolutePath);\n
  \   return new Response(readStream as any, {\n     status: 200,\n    });\n   }\n
  \  return undefined;\n  });\n ```\n\n### Example scenario\nTo reproduce it, set
  `staticFiles` to the relative path of a directory in `.meshrc.yml`;\n\n```yml\nserve:\n
  \ staticFiles: ./public\n```\n\nThen start the server with `mesh dev`, and browse
  to `/..%2fpackage.json` then you will see the content of `package.json`. You can
  even go deeper to see sensitive data; `/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd`\n\n###
  Impact and solution\nIf `staticFiles` is set under `serve` in the configuration
  file. you have two options to fix vulnerability;\n\n- Update `@graphql-mesh/cli`
  to a version higher than `0.82.21`, and if you use `@graphql-mesh/http`, update
  it to a version higher than `0.3.18`\n- Remove `staticFiles` option from the configuration,
  and use other solutions to serve static files.\n\n### Credits\nThanks [alanwillms@gmail.com](mailto:alanwillms@gmail.com)
  for reporting this vulnerability with details"
date: "2023-02-16"
pubdate: "2023-02-16"
affected_range: "<0.3.19"
fixed_versions:
- "0.3.19"
affected_versions: "All versions before 0.3.19"
not_impacted: "All versions starting from 0.3.19"
solution: "Upgrade to version 0.3.19 or above."
urls:
- "https://github.com/Urigo/graphql-mesh/security/advisories/GHSA-j2wh-wrv3-4x4g"
- "https://github.com/Urigo/graphql-mesh/commit/95d93e7c140c2995b37e9d822aa3fe4e24ed2e78"
- "https://github.com/advisories/GHSA-j2wh-wrv3-4x4g"
uuid: "4e789e79-afaa-4272-8d6e-6fbf9bdc036b"
cwe_ids:
- "CWE-1035"
- "CWE-937"
