---
identifier: "CVE-2021-37713"
identifiers:
- "CVE-2021-37713"
- "GHSA-5955-9wpr-37jh"
package_slug: "npm/tar"
title: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
description: "The npm package \"tar\" (aka node-tar) has an arbitrary file creation/overwrite
  and arbitrary code execution vulnerability. node-tar aims to guarantee that any
  file whose location would be outside of the extraction target directory is not extracted.
  This is, in part, accomplished by sanitizing absolute paths of entries within the
  archive, skipping archive entries that contain `..` path portions, and resolving
  the sanitized paths against the extraction target directory. This logic was insufficient
  on Windows systems when extracting tar files that contained a path that was not
  an absolute path, but specified a drive letter different from the extraction target,
  such as `C:some\\path`. If the drive letter does not match the extraction target,
  for example `D:\\extraction\\dir`, then the result of `path.resolve(extractionDirectory,
  entryPath)` would resolve against the current working directory on the `C:` drive,
  rather than the extraction target directory. Additionally, a `..` portion of the
  path could occur immediately after the drive letter, such as `C:../foo`, and was
  not properly sanitized by the logic that checked for `..` within the normalized
  and split portions of the path. This only affects users of `node-tar` on Windows
  systems. These issues were addressed in releases The v3 branch of node-tar has been
  deprecated and did not receive patches for these issues. If you are still using
  a v3 release we recommend you update to a more recent version of node-tar. There
  is no reasonable way to work around this issue without performing the same path
  normalization procedures that node-tar now does. Users are encouraged to upgrade
  to the latest patched versions of node-tar, rather than attempt to sanitize paths
  themselves."
date: "2021-10-20"
pubdate: "2021-08-31"
affected_range: "<=4.4.17||>=5.0.0 <=5.0.9||>=6.0.0 <=6.1.8"
fixed_versions:
- "4.4.18"
- "5.0.10"
- "6.1.9"
affected_versions: "All versions up to 4.4.17, all versions starting from 5.0.0 up
  to 5.0.9, all versions starting from 6.0.0 up to 6.1.8"
not_impacted: "All versions after 4.4.17 before 5.0.0, all versions after 5.0.9 before
  6.0.0, all versions after 6.1.8"
solution: "Upgrade to versions 4.4.18, 5.0.10, 6.1.9 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-37713"
- "https://github.com/npm/node-tar/security/advisories/GHSA-5955-9wpr-37jh"
- "https://www.npmjs.com/package/tar"
- "https://www.oracle.com/security-alerts/cpuoct2021.html"
cvss_v2: "AV:L/AC:M/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H"
uuid: "0d9593eb-b60c-4660-be63-86a74d5fe541"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-937"
