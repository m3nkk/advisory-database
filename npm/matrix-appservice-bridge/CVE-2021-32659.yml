---
identifier: "CVE-2021-32659"
package_slug: "npm/matrix-appservice-bridge"
title: "Missing Authentication for Critical Function"
description: "Matrix-appservice-bridge is the bridging service for the Matrix communication
  program's application services., if a bridge has room upgrade handling turned on
  in the configuration (the `roomUpgradeOpts` key when instantiating a new `Bridge`
  instance.), any `m.room.tombstone` event it encounters will be used to unbridge
  the current room and bridge into the target room. However, the target room `m.room.create`
  event is not checked to verify if the `predecessor` field contains the previous
  room. This means that any malicious admin of a bridged room can repoint the traffic
  to a different room without the new room being aware. and greater are patched. As
  a workaround, disabling the automatic room upgrade handling can be done by removing
  the `roomUpgradeOpts` key from the `Bridge` class options."
date: "2021-07-09"
pubdate: "2021-06-16"
affected_range: "<2.6.1"
fixed_versions:
- "2.6.1"
affected_versions: "All versions before 2.6.1"
not_impacted: "All versions starting from 2.6.1"
solution: "Upgrade to version 2.6.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-32659"
cvss_v2: "AV:N/AC:M/Au:S/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N"
uuid: "0a45442a-92f4-44c9-83ef-d66822ee0fe2"
