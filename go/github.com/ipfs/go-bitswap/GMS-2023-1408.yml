---
identifier: "GMS-2023-1408"
identifiers:
- "GHSA-q3j6-22wf-3jh9"
- "GMS-2023-1408"
package_slug: "go/github.com/ipfs/go-bitswap"
title: "github.com/ipfs/go-bitswap vulnerable to DOS unbounded persistent memory leak"
description: "This package has been moved to [`github.com/ipfs/boxo/bitswap`](https://pkg.go.dev/github.com/ipfs/boxo/bitswap),
  this vulnerability is tracked there: https://github.com/ipfs/boxo/security/advisories/GHSA-m974-xj4j-7qv5
  (`CVE-2023-25568`)\n\n### Remediation\nThis is a two step process:\n1. Apply one
  of:\n  - (**recommended**) upgrade from `github.com/ipfs/go-bitswap` to `github.com/ipfs/boxo/bitswap`.\n
  \ - If you are still using `github.com/ipfs/go-bitswap` and cannot upgrade to `boxo`,
  you can upgrade to `github.com/ipfs/go-bitswap@v0.12.0`, this will replace the `go-bitswap`
  implementation by stubs which points to `boxo`.\n2. Open https://github.com/ipfs/boxo/security/advisories/GHSA-m974-xj4j-7qv5
  and then follow `boxo`'s remediation section.\n\n### Vulnerable symbols\n- `>= v0.9.0;
  < v0.12.0`\n - `github.com/ipfs/go-bitswap/server/internal/decision.(*Engine).MessageReceived`\n
  - `github.com/ipfs/go-bitswap/server/internal/decision.(*Engine).NotifyNewBlocks`\n
  - `github.com/ipfs/go-bitswap/server/internal/decision.(*Engine).findOrCreate`\n
  - `github.com/ipfs/go-bitswap/server/internal/decision.(*Engine).PeerConnected`\n-
  `v0.8.0`\n - `github.com/ipfs/go-bitswap/internal/decision.(*Engine).MessageReceived`\n
  - `github.com/ipfs/go-bitswap/internal/decision.(*Engine).NotifyNewBlocks`\n - `github.com/ipfs/go-bitswap/internal/decision.(*Engine).findOrCreate`\n
  - `github.com/ipfs/go-bitswap/internal/decision.(*Engine).PeerConnected`\n- `< v0.8.0`\n
  - `github.com/ipfs/go-bitswap/internal/decision.(*Engine).MessageReceived`\n - `github.com/ipfs/go-bitswap/internal/decision.(*Engine).receiveBlocksFrom`\n
  - `github.com/ipfs/go-bitswap/internal/decision.(*Engine).findOrCreate`\n - `github.com/ipfs/go-bitswap/internal/decision.(*Engine).PeerConnected`\n\n###
  Workarounds\nIf you are using the stubs at `github.com/ipfs/go-bitswap` and not
  taking advantage of the features provided by the server, refactoring your code to
  use the new split API will allows you to run in a client-only mode using: [`github.com/ipfs/go-bitswap/client`](https://pkg.go.dev/github.com/ipfs/go-bitswap/client)."
date: "2023-05-11"
pubdate: "2023-05-11"
affected_range: "<v0.12.0"
fixed_versions:
- "v0.12.0"
affected_versions: "All versions before 0.12.0"
not_impacted: "All versions starting from 0.12.0"
solution: "Upgrade to version 0.12.0 or above."
urls:
- "https://github.com/ipfs/boxo/security/advisories/GHSA-m974-xj4j-7qv5"
- "https://github.com/ipfs/go-bitswap/security/advisories/GHSA-q3j6-22wf-3jh9"
- "https://github.com/ipfs/go-libipfs/security/advisories/GHSA-m974-xj4j-7qv5"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-25568"
- "https://github.com/advisories/GHSA-q3j6-22wf-3jh9"
uuid: "6a2db8af-c92c-4103-bbda-b22ed71535ab"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v0.12.0"
  commit:
    tags:
    - "v0.12.0"
    sha: "580c92268a30f67a98f40635efe1933277e9a649"
    timestamp: "20230127220034"
