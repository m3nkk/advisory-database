---
identifier: "GMS-2022-1086"
identifiers:
- "GHSA-wm2r-rp98-8pmh"
- "GMS-2022-1086"
package_slug: "go/github.com/rancher/rancher"
title: "Exposure of SSH credentials in Rancher/Fleet"
description: "### Impact\nThis vulnerability only affects customers using Fleet for
  continuous delivery with authenticated Git and/or Helm repositories.\n\nA security
  vulnerability ([CVE-2022-29810](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29810))
  was discovered in `go-getter` library in versions prior to [`v1.5.11`](https://github.com/hashicorp/go-getter/releases/tag/v1.5.11)
  that exposes SSH private keys in base64 format due to a failure in redacting such
  information from error messages. The vulnerable version of this library is used
  in Rancher through Fleet in versions of Fleet prior to [`v0.3.9`](https://github.com/rancher/fleet/releases/tag/v0.3.9).
  This issue affects Rancher versions 2.5.0 up to and including 2.5.12 and from 2.6.0
  up to and including 2.6.3.\n\nWhen Git and/or Helm authentication is configured
  in [Fleet](https://rancher.com/docs/rancher/v2.6/en/deploy-across-clusters/fleet/)
  and Fleet is used to deploy a git repo through `Continuous Delivery`, the affected
  `go-getter` version will expose the configured SSH private key secret if Fleet fails
  to download the git repo due to a misconfigured URL. The exposed SSH key is logged
  in base64 format as a query parameter together with the git URL. The credentials
  can be seen in Rancher UI and in Fleet's deployment pod logs.\n\n### Patches\nPatched
  versions include releases 2.5.13, 2.6.4 and later versions.\n\n### Workarounds\nThere
  is not a direct mitigation besides upgrading to the patched Rancher versions. Until
  you are able to upgrade, limit access in Rancher to trusted users and carefully
  validate the URLs you are using are correct. Please note that the SSH key might
  still be compromised in valid URLs if the service goes down or a connection error
  happens when pulling from the repos.\n\n**Note:** If you believe that SSH keys might
  have been exposed in your environment, it's highly advised to rotate them.\n\n###
  Credits\nThis issue was found and reported by Dagan Henderson from Raft Engineering.\n\n###
  For more information\nIf you have any questions or comments about this advisory:\n*
  Reach out to [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy)
  for security related inquiries.\n* Open an issue in [Rancher](https://github.com/rancher/rancher/issues/new/choose)
  repository.\n* Verify our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/)
  and [product support lifecycle](https://www.suse.com/lifecycle/)."
date: "2022-04-27"
pubdate: "2022-04-27"
affected_range: "<v2.5.13 || >=v2.6.0 <v2.6.4"
fixed_versions:
- "v2.5.13"
- "v2.6.4"
affected_versions: "All versions before 2.5.13, all versions starting from 2.6.0 before
  2.6.4"
not_impacted: "All versions starting from 2.5.13 before 2.6.0, all versions starting
  from 2.6.4"
solution: "Upgrade to versions 2.5.13, 2.6.4 or above."
urls:
- "https://github.com/rancher/rancher/security/advisories/GHSA-wm2r-rp98-8pmh"
- "https://github.com/advisories/GHSA-wm2r-rp98-8pmh"
uuid: "0a50dbb7-64cd-47da-b5c8-c4acc51334c4"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v2.6.0"
  commit:
    tags:
    - "v2.6.0"
    - "v2.6.0-rc10"
    sha: "df2432ad895c9d6be0e47e0d6d62a4c3dc8f08e5"
    timestamp: "20210830223634"
- number: "v2.6.4"
  commit:
    tags:
    - "v2.6.4"
    - "v2.6.4-harvester2"
    - "v2.6.4-harvester3"
    - "v2.6.4-rc16"
    - "v2.6.4-rc17"
    sha: "4b4e29678c0bf932f8e0f79f3895952ce1739f4d"
    timestamp: "20220331015714"
- number: "v2.5.13"
  commit:
    tags:
    - "v2.5.13"
    - "v2.5.13-rc4"
    sha: "7218c48a6f516b72ec4586a790b3b9f1e1fe792b"
    timestamp: "20220415052704"
