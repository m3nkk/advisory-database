---
identifier: "GMS-2022-205"
identifiers:
- "GHSA-j34v-3552-5r7j"
- "GMS-2022-205"
package_slug: "go/github.com/pomerium/pomerium"
title: "Multiple security issues in Pomerium's embedded envoy"
description: "Envoy, which Pomerium is based on, has issued multiple CVEs impacting
  stability and security.\n\nThough Pomerium may not be vulnerable to all of the issues,
  it is recommended that all users upgrade to Pomerium v0.16.4 as soon as possible
  to minimize risk.\n\n### Impact\n\n- Possible DoS or crash\n- Resources available
  to unauthorized users\n- Pomerium may trust upstream certificates that should not
  be trusted\n\n### Patches\nPatched in v0.16.4\n\n### Workarounds\nNo\n\n### References\n\n[Envoy
  Security Announcement](https://groups.google.com/g/envoy-security-announce/c/QBGxoqZdTR4)\n\n*
  [CVE-2021-43824](https://github.com/envoyproxy/envoy/security/advisories/GHSA-vj5m-rch8-5r2p)
  (CVSS Score 6.5, Medium): Envoy 1.21.0 and earlier - Potential null pointer dereference
  when using JWT filter safe_regex match\n* [CVE-2021-43825](https://github.com/envoyproxy/envoy/security/advisories/GHSA-h69p-g6xg-mhhh)
  (CVSS Score 6.1, Medium): Envoy 1.21.0 and earlier - Use-after-free when response
  filters increase response data, and increased data exceeds downstream buffer limits.\n*
  [CVE-2021-43826](https://github.com/envoyproxy/envoy/security/advisories/GHSA-cmx3-fvgf-83mf)
  (CVSS Score 6.1, Medium): Envoy 1.21.0 and earlier - Use-after-free when tunneling
  TCP over HTTP, if downstream disconnects during upstream connection establishment\n*
  [CVE-2022-21654](https://github.com/envoyproxy/envoy/security/advisories/GHSA-5j4x-g36v-m283)
  (CVSS Score 7.3, High): Envoy 1.7.0 and later - Incorrect configuration handling
  allows mTLS session re-use without re-validation after validation settings have
  changed.\n* [CVE-2022-21655](https://github.com/envoyproxy/envoy/security/advisories/GHSA-7r5p-7fmh-jxpg)
  (CVSS Score 7.5, High): Envoy 1.21 and earlier - Incorrect handling of internal
  redirects to routes with a direct response entry\n* [CVE-2022-21657](https://github.com/envoyproxy/envoy/security/advisories/GHSA-837m-wjrv-vm5g)
  (CVSS Score 3.1, Low): Envoy 1.20.1 and earlier - X.509 Extended Key Usage and Trust
  Purposes bypass\n\n### For more information\nIf you have any questions or comments
  about this advisory:\n\nOpen an issue in [pomerium/pomerium](https://github.com/pomerium/pomerium/issues)\nEmail
  us at [security@pomerium.com](mailto:security@pomerium.com)\n"
date: "2022-03-02"
pubdate: "2022-03-01"
affected_range: "<v0.16.4"
fixed_versions:
- "v0.16.4"
affected_versions: "All versions before 0.16.4"
not_impacted: "All versions starting from 0.16.4"
solution: "Upgrade to version 0.16.4 or above."
urls:
- "https://github.com/pomerium/pomerium/security/advisories/GHSA-j34v-3552-5r7j"
- "https://github.com/advisories/GHSA-j34v-3552-5r7j"
uuid: "8e5e71e7-e5ed-4d69-a32a-7208748aa720"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v0.16.4"
  commit:
    tags:
    - "v0.16.4"
    sha: "0d3fa00342cb672ad77c63aa231283db3fcd3052"
    timestamp: "20220225230057"
