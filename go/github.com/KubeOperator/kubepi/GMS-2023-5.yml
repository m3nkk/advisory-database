---
identifier: "GMS-2023-5"
identifiers:
- "GHSA-gqx8-hxmv-c4v4"
- "GMS-2023-5"
- "CVE-2023-22478"
package_slug: "go/github.com/KubeOperator/kubepi"
title: "KubePi may allow unauthorized access to system API"
description: "### Summary\nAPI interfaces with unauthorized access will leak sensitive
  information\n/kubepi/api/v1/systems/operation/logs/search\n/kubepi/api/v1/systems/login/logs/search\n\nThis
  vulnerability also exists in https://github.com/KubeOperator/KubeOperator\n\n###
  Details\nThe vulnerability is located in\nKubePi/internal/api/v1/v1.go\n<img width=\"855\"
  alt=\"image\" src=\"https://user-images.githubusercontent.com/35884266/211234101-8c325e46-bf65-44ee-9fcb-7a1dc3a39c03.png\">\n\n`sp.Post(\"/login/logs/search\",
  handler.LoginLogsSearch())` directly uses the v1 route without middleware authentication\n\n<img
  width=\"961\" alt=\"image\" src=\"https://user-images.githubusercontent.com/35884266/211234091-fe8cf249-8806-4124-92d0-4fd58753fa48.png\">\n\nFollow
  up found no role based authentication\n\n<img width=\"919\" alt=\"image\" src=\"https://user-images.githubusercontent.com/35884266/211234162-0a6cbaa1-1f83-4361-aa26-a72cd117d64d.png\">\n\n`sp.Post(\"/operation/logs/search\",
  handler.OperationLogsSearch())` the same as above\n\n<img width=\"885\" alt=\"image\"
  src=\"https://user-images.githubusercontent.com/35884266/211234385-9d413330-a43b-402a-b389-56a50a109769.png\">\n\n###
  Impact\n\nKubePI <=1.6.3 "
date: "2023-01-09"
pubdate: "2023-01-09"
affected_range: "<=v1.6.3"
fixed_versions: []
affected_versions: "All versions up to 1.6.3"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://github.com/KubeOperator/KubePi/security/advisories/GHSA-gqx8-hxmv-c4v4"
- "https://github.com/advisories/GHSA-gqx8-hxmv-c4v4"
uuid: "d10b7708-6d9f-4a68-ba61-fe85425c142c"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v1.6.3"
  commit:
    tags:
    - "v1.6.3"
    sha: "eead48749050a1bc47c710acb8267211a387a85d"
    timestamp: "20230104102835"
