---
identifier: "GMS-2023-4"
identifiers:
- "GHSA-jxgp-jgh3-8jc8"
- "GMS-2023-4"
- "CVE-2023-22480"
package_slug: "go/github.com/KubeOperator/KubeOperator"
title: "KubeOperator allows unauthorized access to system API"
description: "### Summary\nAPI interfaces with unauthorized access will leak sensitive
  information\n/api/v1/clusters/kubeconfig/<clusterName>\n### Details\nRoutes using
  v1 without any restrictions\n<img width=\"930\" alt=\"image\" src=\"https://user-images.githubusercontent.com/35884266/211258033-84aa14fb-01d5-459c-af81-e48b7552fabf.png\">\n\nDirectly
  pass in `downloadKubeconfig` according to the cluster name\n\n<img width=\"960\"
  alt=\"image\" src=\"https://user-images.githubusercontent.com/35884266/211258011-d885fda6-06c3-4603-be4a-38d9c9b918b4.png\">\npkg/router/v1/white.go\n\nno
  restrictions\n```go\nfunc downloadKubeconfig(ctx context.Context) {\n\tclusterName
  := ctx.Params().GetString(\"name\")\n\tctx.Header(\"Content-Disposition\", \"attachment\")\n\tctx.Header(\"filename\",
  fmt.Sprintf(\"%s-config\", clusterName))\n\tctx.Header(\"Content-Type\", \"application/download\")\n\tclusterService
  := service.NewClusterService()\n\tstr, err := clusterService.GetKubeconfig(clusterName)\n\tif
  err != nil {\n\t\t_, _ = ctx.JSON(err)\n\t\tctx.StatusCode(http.StatusInternalServerError)\n\t}\n\t_,
  _ = ctx.WriteString(str)\n}\n```\n<img width=\"872\" alt=\"image\" src=\"https://user-images.githubusercontent.com/35884266/211258106-79204452-b0b8-4d02-b774-1c2b61dd6bf2.png\">\n\n###
  Impact\nThis is an unauthorized access to the kubeconfig vulnerability, which can
  be used to take over the cluster under certain conditions"
date: "2023-01-09"
pubdate: "2023-01-09"
affected_range: "<=v3.16.3"
fixed_versions: []
affected_versions: "All versions up to 3.16.3"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://github.com/KubeOperator/KubeOperator/security/advisories/GHSA-jxgp-jgh3-8jc8"
- "https://github.com/advisories/GHSA-jxgp-jgh3-8jc8"
uuid: "50ba219c-2176-4665-a5f9-c3fb4cfb4629"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v3.16.3"
  commit:
    tags:
    - "v3.16.3"
    sha: "8205703d0b66ba888ef8a7da0c800037fbf2ac72"
    timestamp: "20230105063507"
