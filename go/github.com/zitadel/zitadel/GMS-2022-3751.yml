---
identifier: "GMS-2022-3751"
identifiers:
- "GHSA-c8fj-4pm8-mp2c"
- "GMS-2022-3751"
- "CVE-2022-36051"
package_slug: "go/github.com/zitadel/zitadel"
title: "Broken Authorization in ZITADEL Actions"
description: "### Impact\n\n**Actions**, introduced in ZITADEL **1.42.0** on the API
  and **1.56.0** for Console, is a feature, where users with role `ORG_OWNER` are
  able to create Javascript Code, which is invoked by the system at certain points
  during the login.\n**Actions**, for example, allow creating authorizations (user
  grants) on newly created users programmatically.\nDue to a missing authorization
  check, **Actions** were able to grant authorizations for projects that belong to
  other organisations inside the same Instance. Granting authorizations via API and
  Console is not affected by this vulnerability.\n\n### Patches\n\n2.x versions are
  fixed on >= [2.2.0](https://github.com/zitadel/zitadel/releases/tag/v2.2.0)\n1.x
  versions are fixed on >= [1.87.1](https://github.com/zitadel/zitadel/releases/tag/v1.87.1)\n\nZITADEL
  recommends upgrading to the latest versions available in due course.\n\n### Workarounds\n\nThere
  is no workaround since a patch is already available.\n\n### Who did disclose this\n\nDuring
  our recurring white box penetration test our external security consultant found
  this issue.\nThe full report will be made public after the complete review.\n\n###
  References\n\nhttps://docs.zitadel.com/docs/guides/manage/customize/behavior\nhttps://docs.zitadel.com/docs/apis/actions\nhttps://zitadel.com/blog/pentest-results-h1-2021\n\n###
  Questions\n\nIf you have any questions or comments about this advisory:\n* Email
  us at [security@zitadel.com](mailto:security@zitadel.com)\n"
date: "2022-08-30"
pubdate: "2022-08-30"
affected_range: ">=1.42.0 <1.87.1||>=2.0.0 <2.2.0"
fixed_versions:
- "1.87.1"
- "2.2.0"
affected_versions: "All versions starting from 1.42.0 before 1.87.1, all versions
  starting from 2.0.0 before 2.2.0"
not_impacted: "All versions before 1.42.0, all versions starting from 1.87.1 before
  2.0.0, all versions starting from 2.2.0"
solution: "Upgrade to versions 1.87.1, 2.2.0 or above."
urls:
- "https://github.com/zitadel/zitadel/security/advisories/GHSA-c8fj-4pm8-mp2c"
- "https://github.com/zitadel/zitadel/pull/4237"
- "https://github.com/zitadel/zitadel/pull/4238"
- "https://github.com/advisories/GHSA-c8fj-4pm8-mp2c"
uuid: "fc35e3d6-4d02-4384-8462-d248358c4202"
cwe_ids:
- "CWE-1035"
- "CWE-937"
