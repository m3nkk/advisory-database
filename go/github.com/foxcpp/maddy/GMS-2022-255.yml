---
identifier: "GMS-2022-255"
identifiers:
- "GHSA-6cp7-g972-w9m9"
- "GMS-2022-255"
- "CVE-2022-24732"
package_slug: "go/github.com/foxcpp/maddy"
title: "Use of a Key Past its Expiration Date in Maddy Mail Server"
description: "### Impact\n\nAny configuration on any maddy version <0.5.4 using auth.pam
  is affected.\n\nNo password expiry or account expiry checking is done when authenticating
  using PAM.\n\n### Patches\n\nPatch is available as part of the 0.5.4 release.\n\n###
  Workarounds\n\nIf /etc/shadow authentication is used, it is possible to replace
  auth.pam with auth.shadow which is not affected.\n\nIt is possible to block list
  expired accounts via existing filtering mechanisms (e.g. auth_map to invalid accounts
  in storage.imapsql).\n\n### References\n\n* https://github.com/foxcpp/maddy/blob/3412e59a2c92106e194fa69f2f1017c020037c9c/internal/auth/pam/pam.c\n*
  https://linux.die.net/man/3/pam_acct_mgmt\n\n### For more information\nIf you have
  any questions or comments about this advisory:\n* Open an issue in https://github.com/foxcpp/maddy\n*
  Email fox.cpp@disroot.org\n"
date: "2022-03-08"
pubdate: "2022-03-07"
affected_range: "<v0.5.4"
fixed_versions:
- "v0.5.4"
affected_versions: "All versions before 0.5.4"
not_impacted: "All versions starting from 0.5.4"
solution: "Upgrade to version 0.5.4 or above."
urls:
- "https://github.com/foxcpp/maddy/security/advisories/GHSA-6cp7-g972-w9m9"
- "https://github.com/foxcpp/maddy/commit/7ee6a39c6a1939b376545f030a5efd6f90913583"
- "https://github.com/foxcpp/maddy/releases/tag/v0.5.4"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-24732"
- "https://github.com/advisories/GHSA-6cp7-g972-w9m9"
uuid: "e15141c4-69df-4329-8c9e-d6323e641111"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v0.5.4"
  commit:
    tags:
    - "v0.5.4"
    sha: "2e5a1f9cafd20e65b264ff0e25648e13b1e3449d"
    timestamp: "20220306133324"
