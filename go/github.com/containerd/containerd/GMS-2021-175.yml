---
identifier: "GMS-2021-175"
identifiers:
- "GHSA-5j5w-g665-5m35"
- "GMS-2021-175"
package_slug: "go/github.com/containerd/containerd"
title: "Ambiguous OCI manifest parsing"
description: "### Impact\n\nIn the OCI Distribution Specification version 1.0.0 and
  prior and in the OCI Image Specification version 1.0.1 and prior, manifest and index
  documents are ambiguous without an accompanying Content-Type HTTP header.  Versions
  of containerd prior to 1.4.12 and 1.5.8 treat the Content-Type header as trusted
  and deserialize the document according to that header.  If the Content-Type header
  changed between pulls of the same ambiguous document (with the same digest), the
  document may be interpreted differently, meaning that the digest alone is insufficient
  to unambiguously identify the content of the image.\n\n### Patches\n\nThis issue
  has been fixed in containerd 1.4.12 and 1.5.8.  Image pulls for manifests that contain
  a “manifests” field or indices which contain a “layers” field are rejected.\n\n###
  Workarounds\n\nEnsure you only pull images from trusted sources.\n\n### References\n\nhttps://github.com/opencontainers/distribution-spec/security/advisories/GHSA-mc8v-mgrf-8f4m\nhttps://github.com/opencontainers/image-spec/security/advisories/GHSA-77vh-xpmg-72qh\n\n###
  For more information\nIf you have any questions or comments about this advisory:\n*
  Open an issue in [containerd](https://github.com/containerd/containerd/issues/new/choose)\n*
  Email us at [security@containerd.io](mailto:security@containerd.io)"
date: "2021-11-18"
pubdate: "2021-11-18"
affected_range: "<1.4.12||>=1.5.0 <1.5.8"
fixed_versions:
- "1.4.12"
- "1.5.8"
affected_versions: "All versions before 1.4.12, all versions starting from 1.5.0 before
  1.5.8"
not_impacted: "All versions starting from 1.4.12 before 1.5.0, all versions starting
  from 1.5.8"
solution: "Upgrade to versions 1.4.12, 1.5.8 or above."
urls:
- "https://github.com/containerd/containerd/security/advisories/GHSA-5j5w-g665-5m35"
- "https://github.com/opencontainers/distribution-spec/security/advisories/GHSA-mc8v-mgrf-8f4m"
- "https://github.com/opencontainers/image-spec/security/advisories/GHSA-77vh-xpmg-72qh"
- "https://github.com/containerd/containerd/releases/tag/v1.4.12"
- "https://github.com/containerd/containerd/releases/tag/v1.5.8"
- "https://github.com/advisories/GHSA-5j5w-g665-5m35"
uuid: "64aca9cf-7680-46d1-8a67-3d43181b53ff"
cwe_ids:
- "CWE-1035"
- "CWE-937"
