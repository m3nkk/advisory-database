---
identifier: "GMS-2022-424"
identifiers:
- "GHSA-w2j5-3rcx-vx7x"
- "GMS-2022-424"
package_slug: "go/github.com/cri-o/cri-o"
title: "Sysctls applied to containers with host IPC or host network namespaces can
  affect the host"
description: "### Impact\nBefore setting the sysctls for a pod, the pods namespaces
  must be unshared (created). However, in cases where the pod is using a host network
  or IPC namespace, a bug in CRI-O caused the namespace creating tool [pinns](https://github.com/cri-o/cri-o/tree/main/pinns/)
  to configure the sysctls of the host. This allows a malicious user to set sysctls
  on the host, assuming they have access to hostNetwork and hostIPC.\n\nAny CRI-O
  cluster after CRI-O 1.18 that drops the infra container\n1.22 and 1.23 clusters
  drop infra container by default, and are thus vulnerable by default.\n\n### Patches\nCRI-O
  versions 1.24.0, 1.23.1, 1.22.2, 1.21.5, 1.20.6, 1.19.5 all have the patches.\n\n###
  Workarounds\nUsers can set `manage_ns_lifecycle` to false, which causes the sysctls
  to be configured by the OCI runtime, which typically filter these cases. This option
  is available in 1.20 and 1.19. Newer versions don't have this option.\nAn admission
  webhook could also be created to deny pods that use host IPC or network namespaces
  and also attempt to configure sysctls related to that namespace.\n\n### For more
  information\nIf you have any questions or comments about this advisory:\n* Open
  an issue in [the CRI-O repo](http://github.com/cri-o/cri-o/issues)\n* To make a
  report, email your vulnerability to the private\n[cncf-crio-security@lists.cncf.io](mailto:cncf-crio-security@lists.cncf.io)
  list\nwith the security details and the details expected for [all CRI-O bug\nreports](https://github.com/cri-o/cri-o/blob/main/.github/ISSUE_TEMPLATE/bug-report.yml)."
date: "2022-03-18"
pubdate: "2022-03-15"
affected_range: ">=1.23.0 <1.23.1||>=1.22.0 <1.22.2||>=1.21.0 <1.21.5||>=1.20.0 <1.20.6||>=1.18.0
  <1.19.5"
fixed_versions:
- "1.23.1"
- "1.23.1"
- "1.23.1"
- "1.23.1"
- "1.23.1"
- "1.21.5"
- "1.20.6"
- "1.19.5"
affected_versions: "All versions starting from 1.23.0 before 1.23.1, all versions
  starting from 1.22.0 before 1.22.2, all versions starting from 1.21.0 before 1.21.5,
  all versions starting from 1.20.0 before 1.20.6, all versions starting from 1.18.0
  before 1.19.5"
not_impacted: "All versions before 1.23.0, all versions starting from 1.23.1, all
  versions before 1.22.0, all versions starting from 1.22.2, all versions before 1.21.0,
  all versions starting from 1.21.5, all versions before 1.20.0, all versions starting
  from 1.20.6, all versions before 1.18.0, all versions starting from 1.19.5"
solution: "Upgrade to versions 1.23.1, 1.23.1, 1.23.1, 1.23.1, 1.23.1, 1.21.5, 1.20.6,
  1.19.5 or above."
urls:
- "https://github.com/cri-o/cri-o/security/advisories/GHSA-w2j5-3rcx-vx7x"
- "https://github.com/advisories/GHSA-w2j5-3rcx-vx7x"
uuid: "5fee36fd-642f-472b-b9d4-34979375051d"
cwe_ids:
- "CWE-1035"
- "CWE-937"
