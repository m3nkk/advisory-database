---
identifier: "CVE-2023-45135"
identifiers:
- "GHSA-ghf6-2f42-mjh9"
- "CVE-2023-45135"
package_slug: "maven/org.xwiki.platform/xwiki-platform-web"
title: "Improper Neutralization of Special Elements used in an OS Command ('OS Command
  Injection')"
description: "XWiki Platform is a generic wiki platform offering runtime services
  for applications built on top of it. In `org.xwiki.platform:xwiki-platform-web`
  versions 7.2-milestone-2 until 14.10.12 and `org.xwiki.platform:xwiki-platform-web-templates`
  prior to versions 14.10.12 and 15.5-rc-1, it is possible to pass a title to the
  page creation action that isn't displayed at first but then executed in the second
  step. This can be used by an attacker to trick a victim to execute code, allowing
  script execution if the victim has script right or remote code execution including
  full access to the XWiki instance if the victim has programming right.\n\nFor the
  attack to work, the attacker needs to convince the victim to visit a link like `<xwiki-host>/xwiki/bin/create/NonExistingSpace/WebHome?title=$services.logging.getLogger(%22foo%22).error(%22Script%20executed!%22)`
  where `<xwiki-host>` is the URL of the Wiki installation and to then click on the
  \"Create\" button on that page. The page looks like a regular XWiki page that the
  victim would also see when clicking the button to create a page that does not exist
  yet, the malicious code is not displayed anywhere on that page. After clicking the
  \"Create\" button, the malicious title would be displayed but at this point, the
  code has already been executed and the attacker could use this code also to hide
  the attack, e.g., by redirecting the victim again to the same page with an innocent
  title. It thus seems plausible that this attack could work if the attacker can place
  a fake \"create page\" button on a page which is possible with edit right.\n\nThis
  has been patched in `org.xwiki.platform:xwiki-platform-web` version 14.10.12 and
  `org.xwiki.platform:xwiki-platform-web-templates` versions 14.10.12 and 15.5-rc-1
  by displaying the title already in the first step such that the victim can notice
  the attack before continuing. It is possible to manually patch the modified files
  from the patch in an existing installation. For the JavaScript change, the minified
  JavaScript file would need to be obtained from a build of XWiki and replaced accordingly."
date: "2023-10-27"
pubdate: "2023-10-25"
affected_range: "[7.2-milestone-2,14.10.12)"
fixed_versions:
- "14.10.12"
affected_versions: "All versions starting from 7.2-milestone-2 before 14.10.12"
not_impacted: "All versions before 7.2-milestone-2, all versions starting from 14.10.12"
solution: "Upgrade to version 14.10.12 or above."
urls:
- "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-ghf6-2f42-mjh9"
- "https://github.com/xwiki/xwiki-platform/commit/199e27ce7016757e66fa7cea99e718044a1b639b"
- "https://jira.xwiki.org/browse/XWIKI-20869"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-45135"
- "https://github.com/advisories/GHSA-ghf6-2f42-mjh9"
uuid: "ec8094b5-7f52-4e2f-9df0-f2229619b5d6"
cwe_ids:
- "CWE-1035"
- "CWE-78"
- "CWE-937"
