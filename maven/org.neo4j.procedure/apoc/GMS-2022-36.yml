---
identifier: "GMS-2022-36"
identifiers:
- "GHSA-4mpj-488r-vh6m"
- "GMS-2022-36"
- "CVE-2021-42767"
package_slug: "maven/org.neo4j.procedure/apoc"
title: "Path traversal in Neo4j Graph Database"
description: "### Impact\nDirectory Traversal Vulnerabilities found in several functions
  of apoc plugins in Neo4j Graph database. The attacker can retrieve and download
  files from outside the configured directory on the affected server. Under some circumstances,
  the attacker can also create files.\n\n### Patches\nThe users should aim to use
  the latest released version compatible with their Neo4j version. The minimum versions
  containing patch for this vulnerability (for Neo4j 4.2, 4.3, and 4.4 bundled with
  APOC, upgrade to the appropriate patched version):\n3.5 - bundle n/a, standalone
  3.5.0.17\n4.2 - bundle 4.2.13, standalone 4.2.10\n4.3 - bundle 4.3.9, standalone
  4.3.0.4\n4.4 - bundle 4.4.2, standalone 4.4.0.1\n\n### Workarounds\nIf you cannot
  upgrade the library, you can control the [allowlist of the functions](https://neo4j.com/docs/operations-manual/current/reference/configuration-settings/#config_dbms.security.procedures.allowlist)
  that can be used in your system:\n\n\n### For more information\nIf you have any
  questions or comments about this advisory:\n* Open an issue in [neo4j-apoc-procedures](https://github.com/neo4j-contrib/neo4j-apoc-procedures)\n*
  Email us at [security@neo4j.com](mailto:security@neo4j.com)\n"
date: "2022-02-01"
pubdate: "2022-02-01"
affected_range: "(,3.5.17),[4.2.0,4.2.10),[4.3.0.0,4.3.0.3],[4.4.0.0]"
fixed_versions:
- "3.5.17"
- "4.2.10"
- "4.3.0.4"
- "4.4.0.1"
affected_versions: "All versions before 3.5.17, all versions starting from 4.2.0 before
  4.2.10, all versions starting from 4.3.0.0 up to 4.3.0.3, version 4.4.0.0"
not_impacted: "All versions starting from 3.5.17 before 4.2.0, all versions starting
  from 4.2.10 before 4.3.0.0, all versions after 4.3.0.3 before 4.4.0.0, all versions
  after 4.4.0.0"
solution: "Upgrade to versions 3.5.17, 4.2.10, 4.3.0.4, 4.4.0.1 or above."
urls:
- "https://github.com/neo4j-contrib/neo4j-apoc-procedures/security/advisories/GHSA-4mpj-488r-vh6m"
- "https://github.com/advisories/GHSA-4mpj-488r-vh6m"
uuid: "803a4905-d3ef-434a-b0c2-37c4216dda33"
cwe_ids:
- "CWE-1035"
- "CWE-937"
