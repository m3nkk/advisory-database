---
identifier: "CVE-2021-30179"
package_slug: "maven/org.apache.dubbo/dubbo"
title: "Deserialization of Untrusted Data"
description: "Apache Dubbo by default supports generic calls to arbitrary methods
  exposed by provider interfaces. These invocations are handled by the GenericFilter
  which will find the service and method specified in the first arguments of the invocation
  and use the Java Reflection API to make the final call. The signature for the $invoke
  or $invokeAsync methods is Ljava/lang/String;[Ljava/lang/String;[Ljava/lang/Object;
  where the first argument is the name of the method to invoke, the second one is
  an array with the parameter types for the method being invoked and the third one
  is an array with the actual call arguments. In addition, the caller also needs to
  set an RPC attachment specifying that the call is a generic call and how to decode
  the arguments. The possible values are: - true - raw.return - nativejava - bean
  - protobuf-json An attacker can control this RPC attachment and set it to nativejava
  to force the java deserialization of the byte array located in the third argument."
date: "2021-06-10"
pubdate: "2021-06-01"
affected_range: "[2.5.0,2.5.10],[2.6.0,2.6.9),[2.7.0,2.7.10)"
fixed_versions:
- "2.7.10"
affected_versions: "All versions starting from 2.5.0 up to 2.5.10, all versions starting
  from 2.6.0 before 2.6.9, all versions starting from 2.7.0 before 2.7.10"
not_impacted: "All versions before 2.5.0, all versions after 2.5.10 before 2.6.0,
  all versions starting from 2.6.9 before 2.7.0, all versions starting from 2.7.10"
solution: "Upgrade to version 2.7.10 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-30179"
- "https://lists.apache.org/thread.html/rccbcbdd6593e42ea3a1e8fedd12807cb111375c9c40edb005ef36f67@%3Cdev.dubbo.apache.org%3E"
- "https://lists.apache.org/thread.html/rccbcbdd6593e42ea3a1e8fedd12807cb111375c9c40edb005ef36f67%40%3Cdev.dubbo.apache.org%3E"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "2c43a75c-6a0e-4a58-b62e-ce26a5533b3e"
