---
identifier: "GMS-2023-98"
identifiers:
- "GHSA-xr8x-pxm6-prjg"
- "GMS-2023-98"
package_slug: "maven/org.hl7.fhir.publisher/org.hl7.fhir.publisher"
title: " MITM based Zip Slip in `org.hl7.fhir.publisher:org.hl7.fhir.publisher`"
description: "### Impact\nMITM can enable Zip-Slip.\n\n### Vulnerability\n\n#### Vulnerability
  1: `Publisher.java`\n\nThere is no validation that the zip file being unpacked has
  entries that are not maliciously writing outside of the intended destination directory.\n\nhttps://github.com/HL7/fhir-ig-publisher/blob/87313e92de6dd6cea816449e0edd225e054a7891/org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools/publisher/Publisher.java#L3598-L3610\n\n####
  Vulnerability 2: `WebSourceProvider.java`\n\nThere is a check for malicious zip
  entries here, but it is not covered by test cases and could potentially be reverted
  in future changes.\n\nhttps://github.com/HL7/fhir-ig-publisher/blob/87313e92de6dd6cea816449e0edd225e054a7891/org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools/web/WebSourceProvider.java#L104-L112\n\n####
  Vulnerability 3: `ZipFetcher.java`\n\nThis retains the path for Zip files in FetchedFile
  entries, which could later be used to output malicious entries to another compressed
  file or file system.\n\nhttps://github.com/HL7/fhir-ig-publisher/blob/87313e92de6dd6cea816449e0edd225e054a7891/org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools/publisher/ZipFetcher.java#L57-L106\n\n####
  Vulnerability 4: `IGPack2NpmConvertor.java`\n\nThe loadZip method retains the path
  for entries in the zip file, which could later be used to output malicious entries
  to another compressed file or file system.\n\nhttps://github.com/HL7/fhir-ig-publisher/blob/87313e92de6dd6cea816449e0edd225e054a7891/org.hl7.fhir.publisher.core/src/main/java/org/hl7/fhir/igtools/publisher/IGPack2NpmConvertor.java#L442-L463\n\n"
date: "2023-01-23"
pubdate: "2023-01-23"
affected_range: "(,1.2.30)"
fixed_versions:
- "1.2.30"
affected_versions: "All versions before 1.2.30"
not_impacted: "All versions starting from 1.2.30"
solution: "Upgrade to version 1.2.30 or above."
urls:
- "https://github.com/HL7/fhir-ig-publisher/security/advisories/GHSA-xr8x-pxm6-prjg"
- "https://github.com/advisories/GHSA-xr8x-pxm6-prjg"
uuid: "87e71ffa-a6f7-4584-b2a1-94f99275f431"
cwe_ids:
- "CWE-1035"
- "CWE-937"
...
