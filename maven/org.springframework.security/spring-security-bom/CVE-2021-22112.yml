---
identifier: CVE-2021-22112
identifiers:
- GHSA-gq28-h5vg-8prx
- CVE-2021-22112
package_slug: maven/org.springframework.security:spring-security-bom
title: Privilege escalation in spring security
description: Spring Security 5.4.x prior to 5.4.4, 5.3.x prior to 5.3.8.RELEASE, 5.2.x
  prior to 5.2.9.RELEASE, and older unsupported versions can fail to save the SecurityContext
  if it is changed more than once in a single request.A malicious user cannot cause
  the bug to happen (it must be programmed in). However, if the application's intent
  is to only allow the user to run with elevated privileges in a small portion of
  the application, the bug can be leveraged to extend those privileges to the rest
  of the application.
date: '2021-10-21'
pubdate: '2021-05-10'
affected_range: "[5.4.0,5.4.4),[5.3.0,5.3.8),(,5.2.9)"
fixed_versions:
- 5.4.4
- 5.2.9
- 5.2.9
affected_versions: All versions starting from 5.4.0 before 5.4.4, all versions starting
  from 5.3.0 before 5.3.8, all versions before 5.2.9
not_impacted: All versions before 5.4.0, all versions starting from 5.4.4, all versions
  before 5.3.0, all versions starting from 5.2.9 before 5.3.8
solution: Upgrade to versions 5.4.4, 5.2.9, 5.2.9 or above.
urls:
- https://nvd.nist.gov/vuln/detail/CVE-2021-22112
- https://github.com/spring-projects/spring-security/releases/tag/5.4.4
- https://tanzu.vmware.com/security/cve-2021-22112
- https://www.jenkins.io/security/advisory/2021-02-19/
- http://www.openwall.com/lists/oss-security/2021/02/19/7
- https://lists.apache.org/thread.html/redbd004a503b3520ae5746c2ab5e93fd7da807a8c128e60d2002cd9b@%3Cissues.nifi.apache.org%3E
- https://www.oracle.com/security-alerts/cpuApr2021.html
- https://lists.apache.org/thread.html/r2cb05e499807900ba23e539643eead9c5f0652fd271f223f89da1804@%3Cpluto-scm.portals.apache.org%3E
- https://lists.apache.org/thread.html/r37423ec7eea340e92a409452c35b649dce02fdc467f0b3f52086c177@%3Cpluto-dev.portals.apache.org%3E
- https://lists.apache.org/thread.html/ra6389b1b82108a3b6bbcd22979f7665fd437c2a3408c9509a15a9ca1@%3Cpluto-dev.portals.apache.org%3E
- https://lists.apache.org/thread.html/r163b3e4e39803882f5be05ee8606b2b9812920e196daa2a82997ce14@%3Cpluto-dev.portals.apache.org%3E
- https://lists.apache.org/thread.html/r3868207b967f926819fe3aa8d33f1666429be589bb4a62104a49f4e3@%3Cpluto-dev.portals.apache.org%3E
- https://lists.apache.org/thread.html/r390783b3b1c59b978131ac08390bf77fbb3863270cbde59d5b0f5fde@%3Cpluto-dev.portals.apache.org%3E
- https://lists.apache.org/thread.html/r413e380088c427f56102968df89ef2f336473e1b56b7d4b3a571a378@%3Cpluto-dev.portals.apache.org%3E
- https://lists.apache.org/thread.html/r89aa1b48a827f5641310305214547f1d6b2101971a49b624737c497f@%3Cpluto-dev.portals.apache.org%3E
- https://lists.apache.org/thread.html/ra53677224fe4f04c2599abc88032076faa18dc84b329cdeba85d4cfc@%3Cpluto-scm.portals.apache.org%3E
- https://www.oracle.com//security-alerts/cpujul2021.html
- https://www.oracle.com/security-alerts/cpuoct2021.html
- https://github.com/advisories/GHSA-gq28-h5vg-8prx
cvss_v2: AV:N/AC:L/Au:S/C:C/I:C/A:C
cvss_v3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
uuid: 65f2b31d-79ac-4a0c-b02b-cbbdc537b74a
cwe_ids:
- CWE-1035
- CWE-937
