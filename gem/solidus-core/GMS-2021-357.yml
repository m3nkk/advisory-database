---
identifier: "GMS-2021-357"
identifiers:
- "GHSA-5629-8855-gf4g"
- "GMS-2021-357"
package_slug: "gem/solidus-core"
title: "Authentication Bypass by CSRF Weakness"
description: "CSRF vulnerability that allows user account takeover. All applications 
  using any version of the frontend component of `solidus_auth_devise` are affected if 
  `protect_from_forgery` method is both; Executed whether as, A before_action callback 
  (the default) or `prepend_before_action` (option `prepend: true` given) before the 
  `:load_object` hook in `Spree::UserController` (most likely order to find).
  Configured to use `:null_session` or `:reset_session strategies` (`:null_session` is 
  the default in case the no strategy is given, but rails --new generated skeleton use 
  `:exception`). That means that applications that haven't been configured differently 
  from what it's generated with Rails aren't affected."
date: "2022-03-02"
pubdate: "2021-11-18"
affected_range: "<2.11.12||>=3.0.0 <3.0.3||>=3.1.0 <3.1.3"
fixed_versions:
- "2.11.12"
- "3.0.3"
- "3.1.3"
affected_versions: "All versions before 2.11.12, all versions starting from 3.0.0
  before 3.0.3, all versions starting from 3.1.0 before 3.1.3"
not_impacted: "All versions starting from 2.11.12 before 3.0.0, all versions starting
  from 3.0.3 before 3.1.0, all versions starting from 3.1.3"
solution: "Upgrade to versions 2.11.12, 3.0.3, 3.1.3 or above."
urls:
- "https://github.com/solidusio/solidus/security/advisories/GHSA-5629-8855-gf4g"
- "https://github.com/solidusio/solidus_auth_devise/security/advisories/GHSA-xm34-v85h-9pg2"
- "https://github.com/advisories/GHSA-5629-8855-gf4g"
uuid: "1060e692-0507-4ede-9cc3-9d54c3ca3620"
cwe_ids:
- "CWE-1035"
- "CWE-937"
