identifier: CVE-2013-6414
title: Denial of Service Vulnerability in Action View
description: "There is a denial of service vulnerability in the header handling component
  of Action View.\r\n\r\nStrings sent in specially crafted headers will be cached
  indefinitely.\r\nThis can cause the cache to grow infinitely, which will eventually
  consume all memory on the target machine, causing a denial of service.\r\n\r\nIf
  you can't upgrade right now, please use this workaround:\r\n\r\n    ActiveSupport.on_load(:action_view)
  do \r\n      ActionView::LookupContext::DetailsKey.class_eval do \r\n        class
  << self \r\n          alias :old_get :get \r\n    \r\n          def get(details)
  \r\n            if details[:formats] \r\n              details = details.dup \r\n
  \             syms = Set.new Mime::SET.symbols \r\n              details[:formats]
  = details[:formats].select { |v| \r\n                syms.include? v \r\n              }
  \r\n            end \r\n            old_get details \r\n          end \r\n        end
  \r\n      end \r\n    end "
date: "2013-12-03"
affected_range: '>=3.0.0 <3.2.16||>=4.0.0.beta1 <4.0.2'
fixed_versions:
- 3.2.16
- 4.0.2
affected_versions: 3.0.0 and later
not_impacted: 2.3.x
solution: Upgrade to latest or use workaround (see source).
credit: Toby Hsieh of SlideShare
urls:
- http://seclists.org/oss-sec/2013/q4/400
uuid: 88c66576-a2a4-421f-a886-ee59cc1ad6f9
package_slug: gem/rails
