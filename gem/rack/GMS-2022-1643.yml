---
identifier: "GMS-2022-1643"
identifiers:
- "GHSA-hxqx-xwvh-44m2"
- "GMS-2022-1643"
- "CVE-2022-30122"
package_slug: "gem/rack"
title: "Denial of Service Vulnerability in Rack Multipart Parsing"
description: "There is a possible denial of service vulnerability in the multipart
  parsing\ncomponent of Rack. This vulnerability has been assigned the CVE identifier\nCVE-2022-30122.\n\nVersions
  Affected: >= 1.2\nNot affected:    < 1.2\nFixed Versions:   2.0.9.1, 2.1.4.1, 2.2.3.1\n\n##
  Impact\nCarefully crafted multipart POST requests can cause Rack's multipart parser
  to\ntake much longer than expected, leading to a possible denial of service\nvulnerability.\n\nImpacted
  code will use Rack's multipart parser to parse multipart posts. This\nincludes directly
  using the multipart parser like this:\n\n```\nparams = Rack::Multipart.parse_multipart(env)\n```\n\nBut
  it also includes reading POST data from a Rack request object like this:\n\n```\np
  request.POST # read POST data\np request.params # reads both query params and POST
  data\n```\n\nAll users running an affected release should either upgrade or use
  one of the\nworkarounds immediately.\n\n## Workarounds\nThere are no feasible workarounds
  for this issue.\n"
date: "2022-05-27"
pubdate: "2022-05-27"
affected_range: ">=1.2 <=2.0.9.0||>=2.1 <=2.1.4.0||>=2.2 <=2.2.3.0"
fixed_versions:
- "2.0.9.1"
- "2.1.4.1"
- "2.2.3.1"
affected_versions: "All versions starting from 1.2 up to 2.0.9.0, all versions starting
  from 2.1 up to 2.1.4.0, all versions starting from 2.2 up to 2.2.3.0"
not_impacted: "All versions before 1.2, all versions after 2.0.9.0 before 2.1, all
  versions after 2.1.4.0 before 2.2, all versions after 2.2.3.0"
solution: "Upgrade to versions 2.0.9.1, 2.1.4.1, 2.2.3.1 or above."
urls:
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2022-30122.yml"
- "https://groups.google.com/g/ruby-security-ann/c/L2Axto442qk"
- "https://github.com/advisories/GHSA-hxqx-xwvh-44m2"
uuid: "20daa17a-47b5-4f79-80c2-cd8f2db9805c"
cwe_ids:
- "CWE-1035"
- "CWE-937"
