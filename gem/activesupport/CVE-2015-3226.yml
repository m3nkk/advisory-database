source_identifier: CVE-2015-3226
title: XSS Vulnerability in ActiveSupport::JSON.encode
description: "When a `Hash` containing user-controlled data is encode as JSON (either
  through `Hash#to_json` or `ActiveSupport::JSON.encode`), Rails does not perform
  adequate escaping that matches the guarantee implied by the `escape_html_entities_in_json`
  option (which is enabled by default). If this resulting JSON string is subsequently
  inserted directly into an HTML page, the page will be vulnerable to XSS attacks.
  \r\n\r\nFor example, the following code snippet is vulnerable to this attack: \r\n\r\n
  \   <%= javascript_tag \"var data = #{user_supplied_data.to_json};\" %> \r\n\r\nSimilarly,
  the following is also vulnerable: \r\n\r\n    <script> \r\n      var data = <%=
  ActiveSupport::JSON.encode(user_supplied_data).html_safe %>; \r\n    </script>"
date: "2015-06-16"
affected_range: '>=4.1.0a <4.1.11||>=4.2.0a <4.2.2'
fixed_versions:
- 4.1.11
- 4.2.2
affected_versions: 4.1.x, 4.2.x
not_impacted: 3.x and 4.0.x
solution: Upgrade to latest, apply patch or use workaround; see provided link.
credit: Francois Chagnon of Shopify
urls:
- https://groups.google.com/forum/#!searchin/rubyonrails-core/CVE-2015-3226/rubyonrails-core/qBUqVlXERag/kuH3wQk1kxUJ
- https://groups.google.com/forum/#!topic/ruby-security-ann/7VlB_pck3hU
uuid: 4888d3dc-f4ac-4765-a7fb-f922bfbdae02
package_slug: gem/activesupport
