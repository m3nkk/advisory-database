---
identifier: CVE-2016-6582
package_slug: gem/doorkeeper
title: Broken token revocation, wrong auth/auth method
description: "Doorkeeper failed to implement OAuth 2.0 Token Revocation (RFC 7009)
  in the\r\nfollowing ways:\r\n\r\n1. Public clients making valid, unauthenticated
  calls to revoke a token\r\n   would not have their token revoked\r\n2. Requests
  were not properly authenticating the *client credentials* but\r\n   were, instead,
  looking at the access token in a second location\r\n3. Because of 2, the requests
  were also not authorizing confidential\r\n   clients' ability to revoke a given
  token. It should only revoke tokens\r\n   that belong to it.\r\n\r\nThe security
  implication is: OAuth 2.0 clients who \"log out\" a user expect\r\nto have the corresponding
  access & refresh tokens revoked, preventing an\r\nattacker who may have already
  hijacked the session from continuing to\r\nimpersonate the victim. Because of the
  bug described above, this is not the\r\ncase. As far as OWASP is concerned, this
  counts as broken authentication\r\ndesign.\r\n\r\nMITRE has assigned CVE-2016-6582
  due to the security issues raised. An\r\nattacker, thanks to 1, can replay a hijacked
  session after a victim logs\r\nout/revokes their token. Additionally, thanks to
  2 & 3, an attacker via a\r\ncompromised confidential client could \"grief\" other
  clients by revoking\r\ntheir tokens (albeit this is an exceptionally narrow attack
  with little\r\nvalue)."
date: '2018-10-09'
pubdate: '2017-01-23'
affected_range: "<4.2.0"
fixed_versions:
- 4.2.0
affected_versions: All versions before 4.2.0
solution: Upgrade to latest version.
urls:
- http://www.openwall.com/lists/oss-security/2016/08/19/2
- https://github.com/doorkeeper-gem/doorkeeper/commit/fb938051777a3c9cb071e96fc66458f8f615bd53
- https://github.com/doorkeeper-gem/doorkeeper/issues/875
credit: Justin Bull (@f3ndot)
cvss_v2: AV:N/AC:L/Au:N/C:N/I:P/A:P
cvss_v3: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
uuid: 0640b4d2-4420-4840-b5dd-6f07f8865408
