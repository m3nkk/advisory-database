---
identifier: "GMS-2023-59"
identifiers:
- "GHSA-579w-22j4-4749"
- "GMS-2023-59"
- "CVE-2022-44566"
package_slug: "gem/activerecord"
title: "Denial of Service Vulnerability in ActiveRecord’s PostgreSQL adapter"
description: "There is a potential denial of service vulnerability present in ActiveRecord’s
  PostgreSQL adapter.\n\nThis has been assigned the CVE identifier CVE-2022-44566.\n\nVersions
  Affected: All. Not affected: None. Fixed Versions: 7.0.4.1, 6.1.7.1\nImpact\n\nIn
  ActiveRecord <7.0.4.1 and <6.1.7.1, when a value outside the range for a 64bit signed
  integer is provided to the PostgreSQL connection adapter, it will treat the target
  column type as numeric. Comparing integer values against numeric values can result
  in a slow sequential scan resulting in potential Denial of Service.\nReleases\n\nThe
  fixed releases are available at the normal locations.\nWorkarounds\n\nEnsure that
  user supplied input which is provided to ActiveRecord clauses do not contain integers
  wider than a signed 64bit representation or floats.\nPatches\n\nTo aid users who
  aren’t able to upgrade immediately we have provided patches for the supported release
  series in accordance with our maintenance policy 1 regarding security issues. They
  are in git-am format and consist of a single changeset.\n\n  6-1-Added-integer-width-check-to-PostgreSQL-Quoting.patch
  - Patch for 6.1 series\n  7-0-Added-integer-width-check-to-PostgreSQL-Quoting.patch
  - Patch for 7.0 series\n"
date: "2023-01-18"
pubdate: "2023-01-18"
affected_range: "<6.1.7.1||>=7.0.0 <7.0.4.1"
fixed_versions:
- "6.1.7.1"
- "7.0.4.1"
affected_versions: "All versions before 6.1.7.1, all versions starting from 7.0.0
  before 7.0.4.1"
not_impacted: "All versions starting from 6.1.7.1 before 7.0.0, all versions starting
  from 7.0.4.1"
solution: "Upgrade to versions 6.1.7.1, 7.0.4.1 or above."
urls:
- "https://github.com/rails/rails/releases/tag/v7.0.4.1"
- "https://github.com/advisories/GHSA-579w-22j4-4749"
uuid: "c16d086a-3f17-4d62-9499-6db6f8352bca"
cwe_ids:
- "CWE-1035"
- "CWE-937"
