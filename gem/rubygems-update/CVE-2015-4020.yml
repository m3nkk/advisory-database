---
identifier: "CVE-2015-4020"
package_slug: "gem/rubygems-update"
title: "Improper Input Validation"
description: "RubyGems  does not validate the hostname when fetching gems or making
  API requests, which allows remote attackers to redirect requests to arbitrary domains
  via a crafted DNS SRV record with a domain that is suffixed with the original domain
  name, aka a \"DNS hijack attack.\" NOTE: this vulnerability exists because to an
  incomplete fix for CVE-2015-3900."
date: "2017-12-09"
pubdate: "2015-08-25"
affected_range: "=11.3||=2.0.0||>=2.0.15 <=2.0.16||=2.0.9||=2.2.0||>=2.4.2 <=2.4.3||=2.0.1||=2.0.10||>=2.0.2
  <=2.0.3||>=2.2.1 <=2.2.2||>=2.4.4 <=2.4.5||=2.0.0||>=2.0.11 <=2.0.12||>=2.0.4 <=2.0.5||>=2.2.3
  <=2.2.4||>=2.4.6 <=2.4.7||=2.0.0||>=2.0.13 <=2.0.14||>=2.0.6 <=2.0.8||>=2.4.0 <=2.4.1"
fixed_versions:
- "0.8.3"
- "0.8.3"
- "0.8.3"
- "0.8.3"
- "0.8.3"
- "0.8.3"
- "0.8.3"
- "0.8.3"
- "2.0.2"
- "2.0.2"
- "2.0.2"
- "2.0.2"
- "2.0.4"
- "2.0.6"
- "2.0.9"
- "2.0.10"
- "2.0.11"
- "2.0.13"
- "2.0.15"
- "2.0.17"
- "2.2.1"
- "2.2.3"
- "2.2.5"
- "2.4.2"
- "2.4.4"
- "2.4.6"
- "2.4.8"
affected_versions: "Version 11.3, version 2.0.0, all versions starting from 2.0.15
  up to 2.0.16, version 2.0.9, version 2.2.0, all versions starting from 2.4.2 up
  to 2.4.3, version 2.0.1, version 2.0.10, all versions starting from 2.0.2 up to
  2.0.3, all versions starting from 2.2.1 up to 2.2.2, all versions starting from
  2.4.4 up to 2.4.5, version 2.0.0, all versions starting from 2.0.11 up to 2.0.12,
  all versions starting from 2.0.4 up to 2.0.5, all versions starting from 2.2.3 up
  to 2.2.4, all versions starting from 2.4.6 up to 2.4.7, version 2.0.0, all versions
  starting from 2.0.13 up to 2.0.14, all versions starting from 2.0.6 up to 2.0.8,
  all versions starting from 2.4.0 up to 2.4.1"
not_impacted: "All versions before 11.3, all versions after 11.3, all versions before
  2.0.0, all versions after 2.0.0 before 2.0.15, all versions after 2.0.16, all versions
  before 2.0.9, all versions after 2.0.9 before 2.2.0, all versions after 2.2.0 before
  2.4.2, all versions after 2.4.3, all versions before 2.0.1, all versions after 2.0.1
  before 2.0.10, all versions after 2.0.10, all versions before 2.0.2, all versions
  after 2.0.3 before 2.2.1, all versions after 2.2.2 before 2.4.4, all versions after
  2.4.5, all versions before 2.0.0, all versions after 2.0.0 before 2.0.11, all versions
  after 2.0.12, all versions before 2.0.4, all versions after 2.0.5 before 2.2.3,
  all versions after 2.2.4 before 2.4.6, all versions after 2.4.7, all versions before
  2.0.0, all versions after 2.0.0 before 2.0.13, all versions after 2.0.14, all versions
  before 2.0.6, all versions after 2.0.8 before 2.4.0, all versions after 2.4.1"
solution: "Upgrade to versions 0.8.3, 0.8.3, 0.8.3, 0.8.3, 0.8.3, 0.8.3, 0.8.3, 0.8.3,
  2.0.2, 2.0.2, 2.0.2, 2.0.2, 2.0.4, 2.0.6, 2.0.9, 2.0.10, 2.0.11, 2.0.13, 2.0.15,
  2.0.17, 2.2.1, 2.2.3, 2.2.5, 2.4.2, 2.4.4, 2.4.6, 2.4.8 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2015-4020"
- "http://blog.rubygems.org/2015/06/08/2.2.5-released.html"
- "http://blog.rubygems.org/2015/06/08/2.4.8-released.html"
- "https://github.com/rubygems/rubygems/commit/5c7bfb5"
- "https://www.trustwave.com/Resources/SpiderLabs-Blog/Attacking-Ruby-Gem-Security-with-CVE-2015-3900/"
- "https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2015-009/?fid=6478"
- "http://www.oracle.com/technetwork/topics/security/bulletinoct2015-2511968.html"
- "http://www.securityfocus.com/bid/75431"
- "https://puppet.com/security/cve/CVE-2015-3900"
cvss_v2: "AV:N/AC:M/Au:N/C:N/I:P/A:N"
uuid: "025b92ba-2339-41eb-a794-c8f4d01409f1"
cwe_ids:
- "CWE-1035"
- "CWE-20"
- "CWE-937"
