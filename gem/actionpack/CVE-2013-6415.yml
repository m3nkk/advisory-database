---
identifier: CVE-2013-6415
title: XSS Vulnerability in number_to_currency
description: "The number_to_currency helper allows users to nicely format a numeric
  value. The unit parameter is not escaped correctly.\r\nApplication which pass user
  controlled data as the unit parameter are vulnerable to an XSS attack."
date: '2013-12-03'
affected_range: "<3.2.16||>=4.0.0 <4.0.2"
fixed_versions:
- 3.2.16
- 4.0.2
affected_versions: All
not_impacted: You're not impacted if your application does not pass unescaped user
  controlled data as the unit parameter.
solution: 'Upgrade to latest or escape user controlled data passed at the unit parameter
  like this: <%= number_to_currency(1.02, unit: h(params[:currency])) %> '
credit: Ankit Gupta
urls:
- http://seclists.org/oss-sec/2013/q4/402
uuid: d645c583-f278-4ba6-909e-9f75800fce1e
package_slug: gem/actionpack
