identifier: CVE-2013-6421
title: Command injection vulnerability
description: "The unpack_zip() function contains the following code:\r\n\r\nsprout-0.7.246/lib/sprout/archive_unpacker.rb\r\n\r\n60
  zip_dir = File.expand_path(File.dirname(zip_file))\r\n61 zip_name = File.basename(zip_file)\r\n62
  output = File.expand_path(dir)\r\n63 # puts \">> zip_dir: #{zip_dir} zip_name: #{zip_name}
  output: #{output} \" \r\n64 %x(cd #{zip_dir};unzip #{zip_name} -d #{output})\r\n\r\nIf
  the attacker can control zip_dir, zip_name or output then they can possibly \r\nexecute
  shell commands by injecting shell meta characters as input. \r\n\r\nPoC:\r\n\r\nFor
  example: filename;id;.zip\r\n\r\nFrom Gemnasium: same issue in lib/sprout/remote_file_loader.rb
  for earlier versions of the 0.7 branch."
date: "2013-12-03"
affected_range: '>=0.7.0'
fixed_versions: []
affected_versions: <=0.7.246
not_impacted: 0.3 and 0.5 branches
solution: There is no solution for the moment.
credit: Larry W. Cashdollar
urls:
- http://cxsecurity.com/issue/WLB-2013120023
- https://github.com/lukebayes/project-sprouts/blob/e8e6c60438cd1a4d598645760b00ea005eb1cc2c/lib/sprout/archive_unpacker.rb#L90
uuid: 580566b5-ef09-4a88-9b9d-1f88705d43f8
package_slug: gem/sprout
