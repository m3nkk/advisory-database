identifier: CVE-2013-2119
title: Incorrect temporary file usage
description: "\"Michael Scherer reported that the passenger ruby gem, when used in
  standalone mode, does not use temporary files in a secure manner.  In the lib/phusion_passenger/standalone/main.rb's
  create_nginx_controller function, passenger creates an nginx configuration file
  insecurely and starts nginx with that configuration file:\r\n\r\n       @temp_dir
  \       = \"/tmp/passenger-standalone.#{$$}\"\r\n       @config_filename = \"#{@temp_dir}/config\"\r\n\r\nIf
  a local attacker were able to create a temporary directory that passenger uses and
  supply a custom nginx configuration file they could start an nginx instance with
  their own configuration file.  This could result in a denial of service condition
  for a legitimate service or, if passenger were executed as root (in order to have
  nginx listen on port 80, for instance), this could lead to a local root compromise.\"\r\n"
date: "2013-02-19"
affected_range: '>=3.0.0 <3.0.21 || >=4.0.0 <4.0.5'
fixed_versions:
- 3.0.21
- 4.0.5
affected_versions: 'All versions starting from 3.0.0 before 3.0.21, all versions starting
  from 4.0.0 before 4.0.5'
solution: Update to latest 3.0.X or 4.0.X
credit: Michael Scherer
urls:
- http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2119
- https://bugzilla.redhat.com/show_bug.cgi?id=892813
uuid: 76fb1e27-a19f-46e8-900a-8a7f2b6608e9
package_slug: gem/passenger
cvss_v2: AV:L/AC:L/Au:N/C:P/I:P/A:P
pubdate: '2014-01-03'
