---
identifier: CVE-2020-5217
package_slug: gem/secure_headers
title: Injection Vulnerability
description: "In Secure Headers, a directive injection vulnerability. 
  If user-supplied input was
  passed into `append/override_content_security_policy_directives`, a semicolon could
  be injected leading to directive injection. This could be used to e.g. override
  a script-src directive. Duplicate directives are ignored and the first one wins.
  The directives in `secure_headers` are sorted alphabetically so they pretty much all
  come before `script-src`. A previously undefined directive would receive a value even
  if `SecureHeaders::OPT_OUT` was supplied. The fixed versions will silently convert
  the semicolons to spaces and emit a deprecation warning when this happens. This
  will result in innocuous browser console messages if being exploited/accidentally
  used."
date: '2020-01-30'
pubdate: '2020-01-23'
affected_range: "<3.8.0||>=5.0.0 <5.1.0||>=6.0.0 <6.2.0"
fixed_versions:
- 3.8.0
- 5.1.0
- 6.2.0
affected_versions: All versions before 3.8.0, all versions starting from 5.0.0 before
  5.1.0, all versions starting from 6.0.0 before 6.2.0
not_impacted: All versions starting from 3.8.0 before 5.0.0, all versions starting
  from 5.1.0 before 6.0.0, all versions starting from 6.2.0
solution: Upgrade to versions 3.8.0, 5.1.0, 6.2.0 or above.
urls:
- https://nvd.nist.gov/vuln/detail/CVE-2020-5217
cvss_v2: AV:N/AC:M/Au:N/C:N/I:P/A:N
cvss_v3: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
uuid: 3a9043b9-524b-47b3-b9a6-28c9d167d72c
