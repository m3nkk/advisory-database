---
identifier: CVE-2015-9097
title: SMTP Injection via to/from addresses
description: "Because Mail does not disallow CRLF in email addresses, an attacker
  can inject SMTP commands in specially crafted email addresses passed to RCPT TO
  and MAIL FROM.\r\n\r\nThe injection attack is described in Terada, Takeshi. \"SMTP
  Injection via Recipient Email Addresses.\" 2015. The attacks described in the paper
  \ (Terada, p. 4) can be applied to the library without any modification.\r\n\r\nNot
  affected by this vulnerability:\r\n\r\n- Ruby 2.4.0+ with a fix for CVE-2015-9096.\r\n-
  Applications that do not use SMTP delivery.\r\n- Applications that validate email
  addresses to not include CRLF."
date: '2015-12-01'
affected_range: "<2.5.5.rc1||>=2.6.0.alpha0 <2.6.6.rc1||>=2.7.0.alpha0 <2.7.0.rc1"
fixed_versions:
- 2.5.5.rc1
- 2.6.6.rc1
- 2.7.0.rc1
affected_versions: All versions
solution: Upgrade to latest version.
credit: Takeshi Terada / Mitsui Bussan Secure Directions, Inc.
urls:
- http://www.mbsd.jp/Whitepaper/smtpi.pdf
- https://github.com/mikel/mail/pull/1097
- https://hackerone.com/reports/137631
uuid: e85c00b3-3230-4315-bd39-669b9fb8827f
package_slug: gem/mail
