---
identifier: CVE-2015-9097
package_slug: gem/mail
title: SMTP Injection via to/from addresses
description: "Because Mail does not disallow CRLF in email addresses, an attacker
  can inject SMTP commands in specially crafted email addresses passed to RCPT TO
  and MAIL FROM.\r\n\r\nThe injection attack is described in Terada, Takeshi. \"SMTP
  Injection via Recipient Email Addresses.\" 2015. The attacks described in the paper
  \ (Terada, p. 4) can be applied to the library without any modification.\r\n\r\nNot
  affected by this vulnerability:\r\n\r\n- Ruby 2.4.0+ with a fix for CVE-2015-9096.\r\n-
  Applications that do not use SMTP delivery.\r\n- Applications that validate email
  addresses to not include CRLF."
date: '2017-07-05'
pubdate: '2017-06-12'
affected_range: "<2.5.5.rc1||>=2.6.0.alpha0 <2.6.6.rc1||>=2.7.0.alpha0 <2.7.0.rc1"
fixed_versions:
- 2.5.5.rc1
- 2.6.6.rc1
- 2.7.0.rc1
affected_versions: All versions before 2.5.5.rc1, all versions starting from 2.6.0.alpha0
  before 2.6.6.rc1, all versions starting from 2.7.0.alpha0 before 2.7.0.rc1
solution: Upgrade to latest version.
urls:
- http://www.mbsd.jp/Whitepaper/smtpi.pdf
- https://github.com/mikel/mail/pull/1097
- https://hackerone.com/reports/137631
credit: Takeshi Terada / Mitsui Bussan Secure Directions, Inc.
cvss_v2: AV:N/AC:M/Au:N/C:N/I:P/A:N
cvss_v3: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
uuid: e85c00b3-3230-4315-bd39-669b9fb8827f
