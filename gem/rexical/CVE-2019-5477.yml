---
identifier: "CVE-2019-5477"
package_slug: "gem/rexical"
title: "Improper Neutralization of Special Elements used in an OS Command ('OS Command
  Injection')"
description: "A command injection vulnerability in Nokogiri v1.10.3 allows commands
  to be executed in a subprocess via Ruby's `Kernel.open` method. Processes are vulnerable
  only if the undocumented method `Nokogiri::CSS::Tokenizer#load_file` is being called
  with unsafe user input as the filename. This vulnerability appears in code generated
  by the Rexical gem versions v1.0.6. Rexical is used by Nokogiri to generate lexical
  scanner code for parsing CSS queries. The underlying vulnerability was addressed
  in Rexical v1.0.7 and Nokogiri upgraded to this version of Rexical in Nokogiri v1.10.4."
date: "2020-10-16"
pubdate: "2019-08-16"
affected_range: "<=1.10.3||=16.04||>=18.04 <=19.04||=19.10||=8.0"
fixed_versions:
- "1.0.3"
affected_versions: "All versions up to 1.10.3, version 16.04, all versions starting
  from 18.04 up to 19.04, version 19.10, version 8.0"
not_impacted: "All versions after 1.10.3 before 16.04, all versions after 16.04 before
  18.04, all versions after 19.04 before 19.10, all versions after 19.10, all versions
  before 8.0, all versions after 8.0"
solution: "Upgrade to version 1.0.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2019-5477"
- "https://hackerone.com/reports/650835"
- "https://github.com/tenderlove/rexical/blob/master/CHANGELOG.rdoc"
- "https://github.com/sparklemotion/nokogiri/issues/1915"
- "https://lists.debian.org/debian-lts-announce/2019/09/msg00027.html"
- "https://usn.ubuntu.com/4175-1/"
- "https://security.gentoo.org/glsa/202006-05"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "36f8fc75-da5e-40e9-9bb3-15b423fc85f3"
cwe_ids:
- "CWE-1035"
- "CWE-78"
- "CWE-937"
