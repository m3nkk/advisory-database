---
identifier: "GMS-2022-6767"
identifiers:
- "GHSA-3p7g-wrgg-wq45"
- "GMS-2022-6767"
package_slug: "packagist/ibexa/graphql"
title: "GraphQL queries can expose password hashes"
description: "### Impact\nUnauthenticated GraphQL queries for user accounts can expose
  password hashes of users that have created or modified content, typically but not
  necessarily limited to administrators and editors.\n\n### Patches\nAffected versions:
  Ibexa DXP v3.3.\\*, v4.2.\\*, eZ Platform v2.5.\\*\nResolving versions: Ibexa DXP
  v3.3.28, v4.2.3, eZ Platform v2.5.31\n\n### Workarounds\nRemove the \"passwordHash\"
  entry from \"src/bundle/Resources/config/graphql/User.types.yaml\" in the GraphQL
  package, and other properties like hash type, email, login if you prefer.\n\n###
  References\n\nThis issue was reported to us by Philippe Tranca (\"trancap\") of
  the company Lexfo. We are very grateful for their research, and responsible disclosure
  to us of this critical vulnerability. \n\n### For more information\nIf you have
  any questions or comments about this advisory, please contact Support via your service
  portal."
date: "2022-11-11"
pubdate: "2022-11-10"
affected_range: ">=2.5.0,<2.5.31||>=3.3.0,<3.3.28||>=4.2.0,<4.2.3"
fixed_versions:
- "2.5.31"
- "4.2.3"
- "3.3.28"
affected_versions: "All versions starting from 2.5.0 before 2.5.31, all versions starting
  from 3.3.0 before 3.3.28, all versions starting from 4.2.0 before 4.2.3"
not_impacted: "All versions before 2.5.0, all versions starting from 2.5.31 before
  3.3.0, all versions starting from 3.3.28 before 4.2.0, all versions starting from
  4.2.3"
solution: "Upgrade to versions 2.5.31, 4.2.3, 3.3.28 or above."
urls:
- "https://github.com/ibexa/graphql/security/advisories/GHSA-3p7g-wrgg-wq45"
- "https://github.com/ibexa/graphql/commit/5ae5fb4d1d292ddde8528e040ef8a7c8dd7f9c6d"
- "https://developers.ibexa.co/security-advisories/ibexa-sa-2022-009-critical-vulnerabilities-in-graphql-role-assignment-ct-editing-and-drafts-tooltips"
- "https://github.com/advisories/GHSA-3p7g-wrgg-wq45"
uuid: "5a5cbcef-edd4-4e1d-b861-33fc73715434"
cwe_ids:
- "CWE-1035"
- "CWE-937"
