source_identifier: CVE-2017-6930
title: Language fallback can be incorrect on multilingual sites with node access restrictions
description: "When using node access controls with a multilingual site, Drupal marks
  the untranslated version of a node as the default fallback for access queries. This
  fallback is used for languages that do not yet have a translated version of the
  created node. This can result in an access bypass vulnerability.\r\n\r\nThis issue
  is mitigated by the fact that it only applies to sites that a) use the Content Translation
  module; and b) use a node access module such as Domain Access which implement hook_node_access_records().\r\n\r\nNote
  that the update will mark the node access tables as needing a rebuild, which will
  take a long time on sites with a large number of nodes."
date: "2018-02-21"
affected_range: '<8.4.5'
fixed_versions:
- 8.4.5
affected_versions: Prior to 8.4.5
solution: Upgrade to latest version.
credit: Ken Rickard
urls:
- http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-6930
- https://www.drupal.org/SA-CORE-2018-001
uuid: 9a4fca06-342d-4a8c-a22f-0d24c790c135
package_slug: packagist/drupal/core
