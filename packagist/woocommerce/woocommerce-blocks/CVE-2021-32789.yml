---
identifier: "CVE-2021-32789"
package_slug: "packagist/woocommerce/woocommerce-blocks"
title: "SQL Injection"
description: "woocommerce-gutenberg-products-block is a feature plugin for WooCommerce
  Gutenberg Blocks. An SQL injection vulnerability impacts all WooCommerce sites running
  the WooCommerce Blocks feature plugin between and Via a carefully crafted URL, an
  exploit can be executed against the `wc/store/products/collection-data?calculate_attribute_counts[][taxonomy]`
  endpoint that allows the execution of a read only sql query. There are patches for
  many versions of this package, starting with There are no known workarounds aside
  from upgrading."
date: "2021-08-05"
pubdate: "2021-07-26"
affected_range: ">=2.5.0,<2.5.16||>=2.6.0,<2.6.2||>=2.7.0,<2.7.2||>=2.8.0,<2.8.1||>=2.9.0,<2.9.1||>=3.0.0,<3.0.1||>=3.1.0,<3.1.1||>=3.2.0,<3.2.1||>=3.3.0,<3.3.1||>=3.4.0,<3.4.1||>=3.5.0,<3.5.1||>=5.5.0,<5.5.1||>=5.4.0,<5.4.1||>=5.0.0,<5.0.1||>=5.1.0,<5.1.1||>=5.2.0,<5.2.1||>=5.3.0,<5.3.2||>=4.2.0,<4.2.1||>=4.3.0,<4.3.1||>=4.4.0,<4.4.3||>=4.5.0,<4.5.3||>=4.6.0,<4.6.1||>=4.7.0,<4.7.1||>=4.8.0,<4.8.1||>=4.9.0,<4.9.2||>=3.6.0,<3.6.1||>=3.7.0,<3.7.2||>=3.8.0,<3.8.1||>=3.9.0,<3.9.1||>=4.0.0,<4.0.1||>=4.1.0,<4.1.1"
fixed_versions:
- "1.2.0"
- "1.2.0"
- "1.2.0"
- "1.2.0"
- "2.5.16"
- "2.7.2"
- "3.1.1"
- "3.4.1"
- "3.6.0"
- "3.6.1"
- "3.8.1"
- "4.0.1"
- "4.2.0"
- "4.4.3"
- "4.7.1"
- "4.9.2"
- "5.1.1"
- "5.3.2"
- "5.5.0"
- "5.5.1"
affected_versions: "All versions starting from 2.5.0 before 2.5.16, all versions starting
  from 2.6.0 before 2.6.2, all versions starting from 2.7.0 before 2.7.2, all versions
  starting from 2.8.0 before 2.8.1, all versions starting from 2.9.0 before 2.9.1,
  all versions starting from 3.0.0 before 3.0.1, all versions starting from 3.1.0
  before 3.1.1, all versions starting from 3.2.0 before 3.2.1, all versions starting
  from 3.3.0 before 3.3.1, all versions starting from 3.4.0 before 3.4.1, all versions
  starting from 3.5.0 before 3.5.1, all versions starting from 5.5.0 before 5.5.1,
  all versions starting from 5.4.0 before 5.4.1, all versions starting from 5.0.0
  before 5.0.1, all versions starting from 5.1.0 before 5.1.1, all versions starting
  from 5.2.0 before 5.2.1, all versions starting from 5.3.0 before 5.3.2, all versions
  starting from 4.2.0 before 4.2.1, all versions starting from 4.3.0 before 4.3.1,
  all versions starting from 4.4.0 before 4.4.3, all versions starting from 4.5.0
  before 4.5.3, all versions starting from 4.6.0 before 4.6.1, all versions starting
  from 4.7.0 before 4.7.1, all versions starting from 4.8.0 before 4.8.1, all versions
  starting from 4.9.0 before 4.9.2, all versions starting from 3.6.0 before 3.6.1,
  all versions starting from 3.7.0 before 3.7.2, all versions starting from 3.8.0
  before 3.8.1, all versions starting from 3.9.0 before 3.9.1, all versions starting
  from 4.0.0 before 4.0.1, all versions starting from 4.1.0 before 4.1.1"
not_impacted: "All versions before 2.5.0, all versions starting from 2.5.16 before
  2.6.0, all versions starting from 2.6.2 before 2.7.0, all versions starting from
  2.7.2 before 2.8.0, all versions starting from 2.8.1 before 2.9.0, all versions
  starting from 2.9.1 before 3.0.0, all versions starting from 3.0.1 before 3.1.0,
  all versions starting from 3.1.1 before 3.2.0, all versions starting from 3.2.1
  before 3.3.0, all versions starting from 3.3.1 before 3.4.0, all versions starting
  from 3.4.1 before 3.5.0, all versions starting from 3.5.1 before 5.5.0, all versions
  starting from 5.5.1, all versions before 5.4.0, all versions starting from 5.4.1,
  all versions before 5.0.0, all versions starting from 5.0.1 before 5.1.0, all versions
  starting from 5.1.1 before 5.2.0, all versions starting from 5.2.1 before 5.3.0,
  all versions starting from 5.3.2, all versions before 4.2.0, all versions starting
  from 4.2.1 before 4.3.0, all versions starting from 4.3.1 before 4.4.0, all versions
  starting from 4.4.3 before 4.5.0, all versions starting from 4.5.3 before 4.6.0,
  all versions starting from 4.6.1 before 4.7.0, all versions starting from 4.7.1
  before 4.8.0, all versions starting from 4.8.1 before 4.9.0, all versions starting
  from 4.9.2, all versions before 3.6.0, all versions starting from 3.6.1 before 3.7.0,
  all versions starting from 3.7.2 before 3.8.0, all versions starting from 3.8.1
  before 3.9.0, all versions starting from 3.9.1 before 4.0.0, all versions starting
  from 4.0.1 before 4.1.0, all versions starting from 4.1.1"
solution: "Upgrade to versions 1.2.0, 1.2.0, 1.2.0, 1.2.0, 2.5.16, 2.7.2, 3.1.1, 3.4.1,
  3.6.0, 3.6.1, 3.8.1, 4.0.1, 4.2.0, 4.4.3, 4.7.1, 4.9.2, 5.1.1, 5.3.2, 5.5.0, 5.5.1
  or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-32789"
- "https://woocommerce.com/posts/critical-vulnerability-detected-july-2021/"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "2e746969-1ebf-4fae-9701-86eb94338f6e"
