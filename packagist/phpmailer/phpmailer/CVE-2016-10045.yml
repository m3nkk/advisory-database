---
identifier: CVE-2016-10045
title: Remote Code Execution (0day Patch Bypass/exploit)
description: "The patch for CVE-2016-10033 vulnerability added in PHPMailer 5.2.17
  \r\nsanitizes the `$Sender` variable by applying `escapeshellarg()` escaping\r\nbefore
  the value is passed to `mail()` function.\r\n\r\nIt does not however take into account
  the clashing of the \r\n`escapeshellarg()` function with internal escaping with
  `escapeshellcmd()`\r\nperformed by `mail()` function on the 5th parameter.\r\n\r\nAs
  a result it is possible to inject an extra quote that does not get\r\nproperly escaped
  and break out of the `escapeshellarg()` protection \r\napplied by the patch in PHPMailer
  5.2.17."
date: '2016-12-27'
affected_range: 5.2.18||5.2.19
fixed_versions:
- v5.2.20
affected_versions: 5.2.18, 5.2.19
solution: Upgrade to latest version.
credit: Dawid Golunski
urls:
- https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
- https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html
uuid: 2806fe84-1e8f-411d-b3dd-b209a88a33c5
package_slug: packagist/phpmailer/phpmailer
