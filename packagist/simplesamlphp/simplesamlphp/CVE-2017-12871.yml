---
identifier: CVE-2017-12871
package_slug: packagist/simplesamlphp/simplesamlphp
title: Incorrect IV generation for encryption
description: 'An issue with IV generation has been discovered in the `SimpleSAML\Utils\Crypto::_aesEncrypt()`
  method, where the IV is not generated randomly but based on the first 16 bytes of
  the SHA256 hash of the secret given as a parameter. This unfortunate bug has two
  direct implications: * The security of the secret key is downgraded effectively
  from 256 bits to 128, given that the first 16 bytes were made public in the resulting
  IV. * The security of the encryption is compromised due to the fact that IVs are
  reused if the same secret is used twice, as it happens by default in the `SimpleSAML\Utils\Crypto::aesEncrypt()`
  method, which uses the salt configured as the secret.'
date: '2017-09-05'
pubdate: '2017-09-01'
affected_range: ">=1.14.0,<=1.14.11"
fixed_versions:
- 1.14.12
affected_versions: All versions starting from 1.14.0 up to 1.14.11
solution: Upgrade to latest version.
urls:
- https://github.com/simplesamlphp/simplesamlphp/commit/77df6a932d46daa35e364925eb73a175010dc904
- https://simplesamlphp.org/security/201703-02
credit: Chris Czub (Duo Security)
cvss_v2: AV:N/AC:M/Au:N/C:P/I:N/A:N
cvss_v3: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
uuid: b1ab5b64-8740-4359-8d23-764f74f850a0
