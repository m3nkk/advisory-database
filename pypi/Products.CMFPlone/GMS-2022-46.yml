---
identifier: "GMS-2022-46"
identifiers:
- "GHSA-8w54-22w9-3g8f"
- "GMS-2022-46"
package_slug: "pypi/Products.CMFPlone"
title: "Cross-site Scripting and Open Redirect in Products.CMFPlone"
description: "### Impact\nPlone is vulnerable to reflected cross site scripting and
  open redirect when an attacker can get a compromised version of the image_view_fullscreen
  page in a cache, for example in Varnish.\nThe technique is known as cache poisoning.\nAny
  later visitor can get redirected when clicking on a link on this page.\nUsually
  only anonymous users are affected, but this depends on your cache settings.\n\n###
  Patches\nNo patch is available for the Products.CMFPlone 4 series.\nVersions 5.0
  and higher are not affected, but two other packages used by these versions are affected.\n\n`plone.app.contenttypes`
  has the same problem in all versions, see advisory
  Plone 5.0-5.2, the default Products.ATContentTypes version has the same problem.
  See advisory
  5.2.7 and 6.0.0a3 will be released today and will include these fixes.\n\nFor all
  unpatched versions of the three packages, you can use the following workaround.\n\n###
  Workaround\nMake sure the image_view_fullscreen page is not stored in the cache.\nIn
  Plone:\n\n* Login as Manager and go to Site Setup.\n* Go to the 'Caching' control
  panel. If this does not exist, or 'Enable caching' is not checked, you should normally
  not be vulnerable.\n* Click on the tab 'Caching operations'.\n* Under 'Legacy template
  mappings' locate the ruleset 'Content item view'.\n* From the last column 
  \ remove 'image_view_fullscreen'.\n* Click on Save.\n\n### Reporter\nThis vulnerability
  was responsibly disclosed to the Plone Security Team by Gustav Hansen, F-Secure
  Consulting. Thank you!\n\n### For more information\nIf you have any questions or
  comments about this advisory, email us at security@plone.org
  is also the correct address to use when you want to report a possible vulnerability.\nSee
  our security report policy
date: "2022-01-31"
pubdate: "2022-01-28"
affected_range: "<5.0.0"
fixed_versions:
- "5.0.0"
affected_versions: "All versions before 5.0.0"
not_impacted: "All versions starting from 5.0.0"
solution: "Upgrade to version 5.0.0 or above."
urls:
- "https://github.com/plone/Products.CMFPlone/security/advisories/GHSA-8w54-22w9-3g8f"
- "https://github.com/advisories/GHSA-8w54-22w9-3g8f"
uuid: "126ea653-0e86-47a1-9874-c144acc26dfd"
cwe_ids:
- "CWE-1035"
- "CWE-937"
