---
identifier: "GMS-2022-3903"
identifiers:
- "GHSA-jhjh-776m-4765"
- "GMS-2022-3903"
- "CVE-2022-31152"
package_slug: "pypi/matrix-synapse"
title: "Denial of service due to incorrect application of event authorization rules"
description: "### Impact\n\nThe Matrix specification specifies a list of [event authorization
  rules](https://spec.matrix.org/v1.3/rooms/v10/#authorization-rules) which must be
  checked when determining if an event should be accepted into a room.\n\nIn versions
  of Synapse up to and including v1.61, some of these rules are not correctly applied.
  An attacker could craft events which would be accepted by Synapse but not a spec-conformant
  server, potentially causing divergence in the room state between servers.\n\n###
  Patches\n\nAdministrators of homeservers with federation enabled are advised to
  upgrade to v1.62.0 or higher.\n\n### Workarounds\n\n * Federation can be disabled
  by setting [`federation_domain_allow list`](https://matrix-org.github.io/synapse/latest/usage/configuration/config_documentation.html#federation_domain_allow
  list) to an empty list (`[]`).\n\n### References\n\n * https://github.com/matrix-org/synapse/pull/13087\n
  * https://github.com/matrix-org/synapse/pull/13088\n\n### For more information\n\nIf
  you have any questions or comments about this advisory, e-mail us at [security@matrix.org](mailto:security@matrix.org)."
date: "2022-08-31"
pubdate: "2022-08-31"
affected_range: "<1.62"
fixed_versions:
- "1.62"
affected_versions: "All versions before 1.62"
not_impacted: "All versions starting from 1.62"
solution: "Upgrade to version 1.62 or above."
urls:
- "https://github.com/matrix-org/synapse/security/advisories/GHSA-jhjh-776m-4765"
- "https://github.com/matrix-org/synapse/pull/13087"
- "https://github.com/matrix-org/synapse/pull/13088"
- "https://github.com/matrix-org/synapse/releases/tag/v1.62.0"
- "https://github.com/advisories/GHSA-jhjh-776m-4765"
uuid: "ee7e688b-3366-4dca-8e02-659ee717c475"
cwe_ids:
- "CWE-1035"
- "CWE-937"
