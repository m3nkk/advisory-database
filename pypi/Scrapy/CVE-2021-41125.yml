---
identifier: "CVE-2021-41125"
identifiers:
- "GHSA-jwqp-28gf-p498"
- "CVE-2021-41125"
package_slug: "pypi/Scrapy"
title: "Exposure of Sensitive Information to an Unauthorized Actor"
description: "Scrapy is a high-level web crawling and scraping framework for Python.
  If you use `HttpAuthMiddleware` (i.e. the `http_user` and `http_pass` spider attributes)
  for HTTP authentication, all requests will expose your credentials to the request
  target. This includes requests generated by Scrapy components, such as `robots.txt`
  requests sent by Scrapy when the `ROBOTSTXT_OBEY` setting is set to `True`, or as
  requests reached through redirects. Upgrade to Scrapy and use the new `http_auth_domain`
  spider attribute to control which domains are allowed to receive the configured
  HTTP authentication credentials. If you are using Scrapy or a lower version, and
  upgrading to Scrapy is not an option, you may upgrade to Scrapy instead. If you
  cannot upgrade, set your HTTP authentication credentials on a per-request basis,
  using for example the `w3lib.http.basic_auth_header` function to convert your credentials
  into a value that you can assign to the `Authorization` header of your request,
  instead of defining your credentials globally using `HttpAuthMiddleware`."
date: "2021-10-07"
pubdate: "2021-10-06"
affected_range: "<1.8.1||>=2.0.0,<2.5.1"
fixed_versions:
- "1.8.1"
- "2.5.1"
affected_versions: "All versions before 1.8.1, all versions starting from 2.0.0 before
  2.5.1"
not_impacted: "All versions starting from 1.8.1 before 2.0.0, all versions starting
  from 2.5.1"
solution: "Upgrade to versions 1.8.1, 2.5.1 or above."
urls:
- "https://github.com/scrapy/scrapy/security/advisories/GHSA-jwqp-28gf-p498"
- "https://github.com/scrapy/scrapy/commit/b01d69a1bf48060daec8f751368622352d8b85a6"
- "https://w3lib.readthedocs.io/en/latest/w3lib.html#w3lib.http.basic_auth_header"
- "http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#module-scrapy.downloadermiddlewares.httpauth"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-41125"
- "https://github.com/advisories/GHSA-jwqp-28gf-p498"
cvss_v2: "AV:N/AC:L/Au:S/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
uuid: "9e49807a-6b7f-4b48-9807-80153cab8a4d"
cwe_ids:
- "CWE-1035"
- "CWE-200"
- "CWE-937"
