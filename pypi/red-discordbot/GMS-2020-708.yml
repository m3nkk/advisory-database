---
identifier: "GMS-2020-708"
identifiers:
- "GHSA-mp9m-g7qj-6vqr"
package_slug: "pypi/red-discordbot"
title: "Unauthorized privilege escalation in Mod module"
description: "### Impact\nAn unauthorized privilege escalation exploit has been discovered
  in the Mod module: this exploit allows Discord users with a high privilege level
  within the guild to bypass hierarchy checks when the application is in a specific
  condition that is beyond that user's control. By abusing this exploit, it's possible
  to perform destructive actions within the guild the user has high privileges in.\n\n###
  Patches\nThis exploit has been fixed on version & ``3.4.1``.\n\n### Workarounds\nUnloading
  the Mod module with ``unload mod`` __or__, disabling the ``massban`` command with
  ``command disable global massban`` can render this exploit not accessible. We still
  highly recommend updating to ``3.4.1`` to completely patch this issue.\n\n### References\n*
  https://github.com/Cog-Creators/Red-DiscordBot/commit/726bfd38adfdfaef760412a68e01447b470f438b\n\n###
  For more information\nIf you have any questions or comments about this advisory:\n*
  Open an issue in [Cog-Creators/Red-DiscordBot](https://github.com/Cog-Creators/Red-DiscordBot)\n*
  Over on our [Discord server](https://discord.gg/red)"
date: "2021-10-08"
pubdate: "2020-10-27"
affected_range: "<3.4.1"
fixed_versions:
- "3.4.1"
affected_versions: "All versions before 3.4.1"
not_impacted: "All versions starting from 3.4.1"
solution: "Upgrade to version 3.4.1 or above."
urls:
- "https://github.com/Cog-Creators/Red-DiscordBot/security/advisories/GHSA-mp9m-g7qj-6vqr"
- "https://github.com/Cog-Creators/Red-DiscordBot/commit/726bfd38adfdfaef760412a68e01447b470f438b"
- "https://pypi.org/project/Red-DiscordBot/"
- "https://github.com/Cog-Creators/Red-DiscordBot/releases/tag/3.4.1"
- "https://github.com/advisories/GHSA-mp9m-g7qj-6vqr"
uuid: "afc9fd2c-d02a-4cb1-a57a-041dfc18cc7f"
cwe_ids:
- "CWE-1035"
- "CWE-937"
