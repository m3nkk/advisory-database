---
identifier: "GMS-2020-8"
identifiers:
- "GHSA-f366-4rvv-95x2"
- "GMS-2020-8"
package_slug: "pypi/cryptoauthlib"
title: "Buffer overflow in deprecated USB HALs and stack overflow in USB enumeration"
description: "### Impact\n1) If an application is making use of the deprecated kit
  protocol HALs as the communication channel to the target device an attacker can
  masquerade as a device and return malformed packets of arbitrary length which the
  protocol stack will write to the stack. HALs intended for production use are unaffected
  (I2C, SWI, & SPI) as well as the hidapi HAL (hal_all_platforms_kit_hidapi.c).\n\n2)
  The hidapi HAL can be made to overrun the application stack by attaching more than
  (real or virtual) devices likely resulting in an application crash as this does
  not allow arbitrary data to be written to the stack.\n\n### Patches\nUSB kit enumeration
  has been patched in v3.2.3 for the hidapi HAL (hal_all_platforms_kit_hidapi.c).\n\n###
  Removal of deprecated HALs\nDeprecated usb kit HALs have been removed in v3.2.3.\n\n###
  Workarounds\nThis vulnerability is limited to users of the kit protocol which is
  used with Microchip kits and kit firmware to bridge communication from USB-HID to
  I2C or SWI. It is not expected that kits would be used in an production environment.
  This is an optional component for users as well so they can always compile the library
  without the usb support option.\n\n### Special python packaging notes\nThe python
  package for cryptoauthlib uses date codes for identifying versions. The patched
  version for python packages is \n\n### References\nPlease see [Microchip PSIRT](https://www.microchip.com/design-centers/embedded-security/how-to-report-potential-product-security-vulnerabilities)
  for Microchip's security policy and reporting procedures\n\n### Credits\nSpecial
  thanks to Ruben Santamarta of [IOActive](https://blogs.ioactive.com/) for reporting"
date: "2021-10-04"
pubdate: "2020-10-02"
affected_range: "<20200912"
fixed_versions:
- "20200912"
affected_versions: "All versions before 20200912"
not_impacted: "All versions starting from 20200912"
solution: "Upgrade to version 20200912 or above."
urls:
- "https://github.com/MicrochipTech/cryptoauthlib/security/advisories/GHSA-f366-4rvv-95x2"
- "https://github.com/advisories/GHSA-f366-4rvv-95x2"
uuid: "2d726501-c5a7-4e9d-929a-45bf6be8612b"
cwe_ids:
- "CWE-1035"
- "CWE-937"
