---
identifier: "GMS-2022-1528"
identifiers:
- "GHSA-mw6j-hh29-h379"
- "GMS-2022-1528"
package_slug: "pypi/tensorflow"
title: "`CHECK` failure in depthwise ops via overflows"
description: "### Impact\nThe implementation of depthwise ops in TensorFlow is vulnerable
  to a denial of service via `CHECK`-failure (assertion failure) caused by overflowing
  the number of elements in a tensor:\n\n```python\nimport tensorflow as tf\n\ninput
  = tf.constant(1, shape=[1, 4, 4, 3], dtype=tf.float32)\nfilter_sizes = tf.constant(1879048192,
  shape=[13], dtype=tf.int32)\nout_backprop = tf.constant(1, shape=[1, 4, 4, 3], dtype=tf.float32)\ntf.raw_ops.DepthwiseConv2dNativeBackpropFilter(\n
  \ input=input, filter_sizes=filter_sizes, out_backprop=out_backprop, strides=[1,
  1, 1, 1], padding=\"SAME\")\n```\n \nThis is another instance of [TFSA-2021-198](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/security/advisory/tfsa-2021-198.md)
  (CVE-2021-41197).\n \n### Patches\nWe have patched the issue in GitHub commit [3796cc4fcd93ae55812a457abc96dcd55fbb854b](https://github.com/tensorflow/tensorflow/commit/3796cc4fcd93ae55812a457abc96dcd55fbb854b).\n\nThe
  fix will be included in TensorFlow 2.9.0. We will also cherrypick this commit on
  TensorFlow 2.8.1, TensorFlow 2.7.2, and TensorFlow 2.6.4, as these are also affected
  and still in supported range.\n\n### For more information\nPlease consult [our security
  guide](https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md) for more
  information regarding the security model and how to contact us with issues and questions.\n\n###
  Attribution\nThis vulnerability has been reported by Neophytos Christou from Secure
  Systems Lab at Brown University."
date: "2022-05-25"
pubdate: "2022-05-25"
affected_range: "<2.6.4||>=2.7.0,<2.7.2||>=2.8.0,<2.8.1"
fixed_versions:
- "2.6.4"
- "2.7.2"
- "2.8.1"
affected_versions: "All versions before 2.6.4, all versions starting from 2.7.0 before
  2.7.2, all versions starting from 2.8.0 before 2.8.1"
not_impacted: "All versions starting from 2.6.4 before 2.7.0, all versions starting
  from 2.7.2 before 2.8.0, all versions starting from 2.8.1"
solution: "Upgrade to versions 2.6.4, 2.7.2, 2.8.1 or above."
urls:
- "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-mw6j-hh29-h379"
- "https://github.com/tensorflow/tensorflow/commit/3796cc4fcd93ae55812a457abc96dcd55fbb854b"
- "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/security/advisory/tfsa-2021-198.md"
- "https://github.com/advisories/GHSA-mw6j-hh29-h379"
uuid: "5e0506b5-df1a-4576-b9ec-c18df7cce5fa"
cwe_ids:
- "CWE-1035"
- "CWE-937"
