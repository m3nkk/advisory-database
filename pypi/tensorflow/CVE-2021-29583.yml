---
identifier: "CVE-2021-29583"
package_slug: "pypi/tensorflow"
title: "Out-of-bounds Write"
description: "TensorFlow is an end-to-end open source platform for machine learning.
  The implementation of `tf.raw_ops.FusedBatchNorm` is vulnerable to a heap buffer
  overflow. If the tensors are empty, the same implementation can trigger undefined
  behavior by dereferencing null pointers. The implementation(https://github.com/tensorflow/tensorflow/blob/57d86e0db5d1365f19adcce848dfc1bf89fdd4c7/tensorflow/core/kernels/fused_batch_norm_op.cc)
  fails to validate that `scale`, `offset`, `mean` and `variance` (the last two only
  when required) all have the same number of elements as the number of channels of
  `x`. This results in heap out-of-bounds reads when the buffers backing these tensors
  are indexed past their boundary. If the tensors are empty, the validation mentioned
  in the above paragraph would also trigger and prevent the undefined behavior. The
  fix will be included in TensorFlow We will also cherrypick this commit on TensorFlow,
  TensorFlow, TensorFlow and TensorFlow, as these are also affected and still in supported
  range."
date: "2021-05-20"
pubdate: "2021-05-14"
affected_range: "<=2.1.4||>=2.2.0,<=2.2.3||>=2.3.0,<=2.3.3||>=2.4.0,<=2.4.2"
fixed_versions:
- "2.5.0"
affected_versions: "All versions up to 2.1.4, all versions starting from 2.2.0 up
  to 2.2.3, all versions starting from 2.3.0 up to 2.3.3, all versions starting from
  2.4.0 up to 2.4.2"
not_impacted: "All versions after 2.1.4 before 2.2.0, all versions after 2.2.3 before
  2.3.0, all versions after 2.3.3 before 2.4.0, all versions after 2.4.2"
solution: "Upgrade to version 2.5.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-29583"
cvss_v2: "AV:L/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "011cdf36-8703-4f9a-867f-45549548f2a0"
