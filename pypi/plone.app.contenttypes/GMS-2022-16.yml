---
identifier: "GMS-2022-16"
identifiers:
- "GHSA-f7qw-5fgj-247x"
- "GMS-2022-16"
package_slug: "pypi/plone.app.contenttypes"
title: "Cross-site Scripting and Open Redirect in plone.app.contenttypes"
description: "### Impact\nPlone is vulnerable to reflected cross site scripting and
  open redirect when an attacker can get a compromised version of the image_view_fullscreen
  page in a cache, for example in Varnish.\nThe technique is known as cache poisoning.\nAny
  later visitor can get redirected when clicking on a link on this page.\nUsually
  only anonymous users are affected, but this depends on your cache settings.\n\n###
  Patches\nNew versions of plone.app.contenttypes have been released.\n works on Plone
  and will be included in Plone \n a9 works on Plone 6 and will be included in Plone
  a3.\n\nNote that the Products.CMFPlone package has the same problem in the series.\nIn
  Plone, the default Products.ATContentTypes version has the same problem. See [advisory](https://github.com/plone/Products.ATContentTypes/security/advisories/GHSA-g4c2-ghfg-g5rh).\nFor
  all unpatched versions of the three packages, you can use the following workaround.\n\n###
  Workaround\nMake sure the image_view_fullscreen page is not stored in the cache.\nIn
  Plone:\n\n* Login as Manager and go to Site Setup.\n* Go to the 'Caching' control
  panel. If this does not exist, or 'Enable caching' is not checked, you should normally
  not be vulnerable.\n* Click on the tab 'Caching operations'.\n* Under 'Legacy template
  mappings' locate the ruleset 'Content item view'.\n* From the last column ('Templates')
  remove 'image_view_fullscreen'.\n* Click on Save.\n\n### Reporter\nThis vulnerability
  was responsibly disclosed to the Plone Security Team by Gustav Hansen, F-Secure
  Consulting. Thank you!\n\n### For more information\nIf you have any questions or
  comments about this advisory, email us at [security@plone.org](mailto:security@plone.org)\nThis
  is also the correct address to use when you want to report a possible vulnerability.\nSee
  [our security report policy](https://plone.org/security/report)."
date: "2022-02-01"
pubdate: "2022-02-01"
affected_range: "<2.2.3"
fixed_versions:
- "2.2.3"
affected_versions: "All versions before 2.2.3"
not_impacted: "All versions starting from 2.2.3"
solution: "Upgrade to version 2.2.3 or above."
urls:
- "https://github.com/plone/Products.ATContentTypes/security/advisories/GHSA-g4c2-ghfg-g5rh"
- "https://github.com/plone/plone.app.contenttypes/security/advisories/GHSA-f7qw-5fgj-247x"
- "https://github.com/advisories/GHSA-f7qw-5fgj-247x"
uuid: "cca8dc08-e0ee-430d-a283-da275efcc7a6"
cwe_ids:
- "CWE-1035"
- "CWE-937"
