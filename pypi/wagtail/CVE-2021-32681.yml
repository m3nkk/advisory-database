---
identifier: "CVE-2021-32681"
package_slug: "pypi/wagtail"
title: "Cross-site Scripting"
description: "Wagtail is an open source content management system built on Django.
  A cross-site scripting vulnerability exists , When the `{% include_block %}` template
  tag is used to output the value of a plain-text StreamField block (`CharBlock`,
  `TextBlock` or a similar user-defined block derived from `FieldBlock`), and that
  block does not specify a template for rendering, the tag output is not properly
  escaped as HTML. This could allow users to insert arbitrary HTML or scripting. This
  vulnerability is only exploitable by users with the ability to author StreamField
  content (i.e. users with 'editor' access to the Wagtail admin). Patched versions
  have been released as Wagtail (for the branch), Wagtail, and Wagtail (for the current
  branch). As a workaround, site implementors who are unable to upgrade to a current
  supported version should audit their use of `{% include_block %}` to ensure it is
  not used to output `CharBlock` / `TextBlock` values with no associated template.
  Note that this only applies where `{% include_block %}` is used directly on that
  block (uses of `include_block` on a block _containing_ a CharBlock / TextBlock,
  such as a StructBlock, are unaffected). In these cases, the tag can be replaced
  with Django's `{{ ... }}` syntax - e.g. `{% include_block my_title_block %}` becomes
  `{{ my_title_block }}`."
date: "2021-06-23"
pubdate: "2021-06-17"
affected_range: "<2.11.8||>=2.12,<=2.12.4||>=2.13,<=2.13.1"
fixed_versions:
- "2.11.8"
- "2.12.5"
- "2.13.2"
affected_versions: "All versions before 2.11.8, all versions starting from 2.12 up
  to 2.12.4, all versions starting from 2.13 up to 2.13.1"
not_impacted: "All versions starting from 2.11.8 before 2.12, all versions after 2.12.4
  before 2.13, all versions after 2.13.1"
solution: "Upgrade to versions 2.11.8, 2.12.5, 2.13.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-32681"
cvss_v2: "AV:N/AC:M/Au:S/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N"
uuid: "1d1dd66b-edf8-4f68-9d8a-039d32486855"
